<div class="card-body pb-0">
  <div class="card-title d-flex justify-content-between">
    <h5>Datos de empresa</h5>
    <button class="btn btn-link pt-0 edit" (click)="openConfirm(add)">
      <i class="fas fa-pencil-alt"></i>
    </button>
  </div>
  <div class="rounded-top table-responsive">
    <table class="table table-sm" >
      <thead class="bg-light">
        <tr class="text-center text-uppercase">
          <th>Empresa</th>
          <th>Grupo</th>
          <th>Dependencia</th>
          <th>Cargo</th>
          <th>Turno</th>
          <th *ngIf="empresa.fixed_turn_name">Asignado</th>
        </tr>
      </thead>
      <tbody>
        <tr class="text-center">
          <td class="align-middle">{{ empresa.company_name }}</td>
          <td class="align-middle">{{ empresa.group_name }}</td>
          <td class="align-middle">{{ empresa.dependency_name }}</td>
          <td class="align-middle">{{ empresa.position_name }}</td>
          <td class="align-middle">{{ empresa.turn_type }}</td>
          <td *ngIf="empresa.fixed_turn_name" class="align-middle">{{ empresa.fixed_turn_name }}</td>
        </tr>
      </tbody>
    </table>
  </div>
</div>

<ng-template #add let-modal>
  <div class="modal-header">
    <h4 class="text-primary modal-title">Editar empresa del funcionario</h4>
    <button
      type="button"
      class="close"
      data-dismiss="modal"
      aria-label="Close"
      (click)="modal.dismiss('Cross click')"
    >
      <span aria-hidden="true">&times;</span>
    </button>
  </div>
  <div class="modal-body">
    <form [formGroup]="form">
      <div class="row">
        <mat-form-field class="col-md-6" appearance="outline">
          <mat-label>Grupo</mat-label>
          <mat-select
            formControlName="group_id"
            (selectionChange)="getDependencies($event.value)"
          >
            <mat-option *ngFor="let item of groups" [value]="item.value">{{
              item.text
            }}</mat-option>
          </mat-select>
          <mat-error *ngIf="group_valid"> Campo obligatorio </mat-error>
        </mat-form-field>
        <mat-form-field class="col-md-6" appearance="outline">
          <mat-label>Dependencia</mat-label>
          <mat-select
            formControlName="dependency_id"
            (selectionChange)="getPositions($event.value)"
          >
            <mat-option *ngFor="let item of dependencies" [value]="item.value">{{
              item.text
            }}</mat-option>
          </mat-select>
          <mat-error *ngIf="dependency_valid"> Campo obligatorio </mat-error>
        </mat-form-field>
        <mat-form-field class="col-md-6" appearance="outline">
          <mat-label>Cargo</mat-label>
          <mat-select formControlName="position_id">
            <mat-option *ngFor="let item of positions" [value]="item.value">{{
              item.text
            }}</mat-option>
          </mat-select>
          <mat-error *ngIf="position_valid"> Campo obligatorio </mat-error>
        </mat-form-field>
        <mat-form-field class="col-md-6" appearance="outline">
          <mat-label>Turno</mat-label>
          <mat-select (selectionChange)="turnChanged($event.value)" formControlName="turn_type">
            <mat-option *ngFor="let item of turnos" [value]="item.value">{{
              item.text
            }}</mat-option>
          </mat-select>
          <mat-error *ngIf="turn_valid"> Campo obligatorio </mat-error>
        </mat-form-field>
        <mat-form-field
          class="col-md-12"
          appearance="outline"
          *ngIf="turnSelected == 'Fijo'"
        >
          <mat-label>Turno asignado</mat-label>
          <mat-select formControlName="fixed_turn_id">
            <mat-option *ngFor="let item of fixed_turns" [value]="item.value">{{
              item.text
            }}</mat-option>
          </mat-select>
          <mat-error *ngIf="fixed_turn_valid"> Campo obligatorio </mat-error>
        </mat-form-field>
      </div>
    </form>
  </div>
  <div class="modal-footer">
    <button
      type="button"
      class="btn btn-danger"
      (click)="modal.dismiss('Cross click')"
    >
      Cancelar
    </button>
    <button
      type="button"
      [disabled]="!form.valid"
      (click)="updateEnterpriseData()"
      class="btn btn-primary"
    >
      Guardar
    </button>
  </div>
</ng-template>
