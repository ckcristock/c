<div class="page-body">
  <div class="row">
    <div class="col-sm-4">
      <div class="card">
        <div class="card-body">
          <div class="card-title">
            <h4 class="text-primary">Seguimiento Orden Compra</h4>
          </div>
          <hr class="line">
          <ul class="list-group list-group-flush">
            <li class="list-group-item" *ngFor="let Actividad of Actividades">
              <div class="row">
                <div class="col-10">
                  <h5 class="mb-1 label {{
                    Actividad.Estado == 'Creacion' ? 'label-info' : ''
                  }} {{
                    Actividad.Estado == 'Edicion' ? 'label-warning' : ''
                  }}{{
                    Actividad.Estado == 'Anulada' ||
                    Actividad.Estado == 'Rechazada'
                      ? 'label-danger'
                      : ''
                  }}{{
                    Actividad.Estado == 'Recepcion' ? 'label-inverse' : ''
                  }} {{
                    Actividad.Estado == 'Aprobacion' ? 'label-success ' : ''
                  }}">
                    {{ Actividad.Estado }}
                  </h5>
                </div>

                <div class="col-2">
                  <img class="img-fluid rounded-circle" [src]="Actividad.Imagen" href="javascript:"
                    onerror="this.src='../../../../../assets/images/nofound.png'" />
                </div>

              </div>
              <p class="mb-1">{{ Actividad.Detalles }}</p>
              <small>{{ Actividad.Fecha }}</small>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="col-sm-8">
      <div class="card">
        <div class="card-body">
          <div class="card-title d-flex justify-content-between">
            <div class="row">
              <table class="table table-responsive invoice-table table-borderless">
                <tbody>
                  <tr>
                    <td>
                      <!--    <img src="assets/images/logo-color.png" class="m-b-10 img-60" alt="Pro-H Software"> -->
                    </td>
                    <td>
                      <!-- TODO Nombre de empresa -->
                      <!--  {{globales.Nombre}}
                          <br> {{globales.Nit}}
                          <br> {{globales.Direccion}}
                          <br> Punto Bucaramanga Centro
                          <br> {{globales.Telefono}} -->
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="row">
              <div class="col">
                <h4 class="text-primary">{{ Compra.Codigo }} - {{ Compra.Estado }}</h4>
                <h6>{{ Fecha | date: "longDate" }}</h6>
              </div>
            </div>
          </div>
          <hr class="line">
          <div class="container mt-4">
            <table class="table table-bordered table-striped table-sm" style="font-size: small;">
              <thead>
                <tr>
                  <th style="text-align: center">Proveedor</th>
                  <th style="text-align: center">Bodega</th>
                  <th style="text-align: center">Fecha de Compra</th>
                  <th style="text-align: center">Fecha Probable de Entrega</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>
                    {{ Compra.Proveedor }}
                  </td>
                  <td>
                    {{ Compra.Bodega }}
                  </td>
                  <td>
                    {{ Compra.Fecha_Compra | date: "dd/MM/yyyy" }}
                  </td>
                  <td>
                    {{ Compra.Fecha_Probable }}
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
          <div class="clearfix"></div>
          <hr class="line">
          <div class="container mt-4">
            <h6>Observaciones</h6>
            <p>{{ Compra.Observaciones }}</p>
          </div>
          <hr class="line">
          <div class="container mt-4">
            <table class="table table-bordered table-striped table-sm" style="font-size: small;">
              <thead>
                <tr>
                  <th></th>
                  <th>Producto</th>
                  <th>Embalaje</th>
                  <th>Cantidad</th>
                  <th>Costo</th>
                  <th>IVA</th>
                  <th>SubTotal</th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let Producto of Productos; let i = index" id="fila{{ i }}">
                  <td class="text-center">
                    <strong>{{ i + 1 }}</strong>
                  </td>
                  <td class="text-left">
                    <strong>{{ Producto.Nombre_Comercial }}</strong>
                    <p>
                      {{ Producto.Nombre_Producto }}
                    </p>
                  </td>
                  <td>
                    <p class="text-muted">
                      {{ Producto.Embalaje }}
                    </p>
                  </td>
                  <td class="text-center">
                    {{ Producto.Cantidad | number | puntos }}
                  </td>
                  <td class="text-right">{{ Producto.Costo | currency }}</td>
                  <td>{{ Producto.Iva }} %</td>
                  <td class="text-right">{{ Producto.Total | currency }}</td>
                </tr>
              </tbody>
            </table>
          </div>
          <div class="container mt-4">
            <div class="col-6">
              <table class="table table-hover">
                <tbody>
                  <tr>
                    <th>SubTotal :</th>
                    <td>$ {{ SubTotalFinal }}</td>
                  </tr>
                  <tr>
                    <th>Iva :</th>
                    <td>$ {{ IvaFinal }}</td>
                  </tr>
                  <tr>
                    <th>Total :</th>
                    <td>$ {{ TotalFinal }}</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>

          <!-- TODO APROBAR COMPRA -->
          <div class="container mt-4" *ngIf="permiso && Compra.Aprobacion == 'Pendiente'">
            <div class="row">
              <div class="col text-center">
                <div class="btn-group" role="group" aria-label="Button group">
                  <button class="btn btn-success btn-sm" [swal]="{
                    title: '¿Está Seguro?',
                    text: 'Se dispone a aprobar esta Orden de Compra para Proceder a Solicitarla',
                    icon: 'warning',
                    showCancelButton: true,
                    confirmButtonText: 'Si, Aprobar',
                    cancelButtonText: 'No, Dejame Comprobar!'
                  }" (confirm)="EstadoAprobacion('', 'Aprobada')" type="button">
                    <i class="fa fa-thumbs-up"></i> Aprobar y proceder
                  </button>
                  <button class="btn btn-danger btn-sm" [swal]="{
                  title: '¿Está Seguro?',
                  text: 'Se dispone a rechazar esta Orden de Compra, por favor seleccione un motivo',
                  icon: 'warning',
                  input: 'select',
                  inputOptions: Lista_Rechazo,
                  inputPlaceholder: 'Seleccione un Motivo',
                  showCancelButton: true,
                  confirmButtonText: 'Si, Rechazar',
                  cancelButtonText: 'No, Dejame Comprobar!'
                }" (confirm)="EstadoAprobacion($event, 'Rechazada')" type="button">
                    <i class="fa fa-thumbs-down"></i> Rechazar
                  </button>
                </div>
              </div>
            </div>

          </div>
          
          <!-- TODO PENDIENTE IMPRIMIR -->
          <!-- <a href="{{environment.ruta}}php/comprasnacionales/descarga_pdf.php?tipo=Orden_Compra_Nacional&id={{id}}" target="_blank" class="btn btn-success btn-sm m-l-5 pull-right" style="margin-right: 10px;">
              <i class="fa fa-print"></i> IMPRIMIR DOCUMENTO</a> -->
        </div>
      </div>
    </div>
  </div>
</div>

<swal #confirmacionSwal title="" text="" icon=""></swal>