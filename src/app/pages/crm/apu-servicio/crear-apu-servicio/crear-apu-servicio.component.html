<ng-template #placeholder>
  <app-placeholder-form></app-placeholder-form>
</ng-template>
<ng-container *ngIf="!loading && form; else placeholder">
  <form [formGroup]="form">
    <div class="card">
      <div class="card-body">
        <app-cabecera [datosCabecera]="datosCabecera"></app-cabecera>
        <hr class="line" />
        <div class="row">
          <mat-form-field class="col-md-6" appearance="outline">
            <mat-label>Nombre servicio</mat-label>
            <input
              matInput
              type="text"
              placeholder="Ingresa el nombre"
              formControlName="name"
              required
            />
          </mat-form-field>
          <mat-form-field class="col-md-6" appearance="outline">
            <mat-label>Conjunto</mat-label>
            <input
              matInput
              type="text"
              placeholder="Ingresa el conjunto"
              formControlName="set_name"
              autocomplete="off"
            />
          </mat-form-field>
          <mat-form-field class="col-md-6" appearance="outline">
            <mat-label>Máquina</mat-label>
            <input
              matInput
              type="text"
              placeholder="Ingresa la máquina"
              formControlName="machine_name"
              autocomplete="off"
            />
          </mat-form-field>
          <div class="col-md-6 mat-form-field-wrapper">
            <ng-select
              formControlName="city_id"
              [items]="cities"
              bindLabel="text"
              appearance="outline"
              [clearable]="false"
              [class.is-invalid]="form?.get('city_id')?.invalid"
              [appendTo]="'body'"
              placeholder="Destino *"
              bindValue="value"
              loadingText="loading"
              ngDefaultControl
            >
            </ng-select>
          </div>
          <div class="col-md-6 mat-form-field-wrapper">
            <ng-select
              formControlName="third_party_id"
              [items]="clients"
              bindLabel="text"
              appearance="outline"
              [clearable]="false"
              [class.is-invalid]="form?.get('third_party_id')?.invalid"
              [appendTo]="'body'"
              placeholder="Cliente *"
              bindValue="value"
              loadingText="loading"
              ngDefaultControl
            >
            </ng-select>
          </div>
          <mat-form-field class="col-md-6" appearance="outline">
            <mat-label>Línea</mat-label>
            <input
              matInput
              type="text"
              placeholder="Ingresa la línea"
              formControlName="line"
              required
            />
          </mat-form-field>
          <mat-form-field
            class="col-md-12 mat-form-field-no-padding textarea"
            appearance="outline"
          >
            <mat-label>Observaciones</mat-label>
            <textarea
              matInput
              placeholder="Ingrese las observaciones"
              rows="5"
              formControlName="observation"
              [cdkTextareaAutosize]="true"
            ></textarea>
          </mat-form-field>
        </div>
      </div>
    </div>
    <mat-accordion multi>
      <mat-expansion-panel
        [expanded]="
          cmoList?.controls?.length > 0 ||
          mpMCalculateLaborList?.controls?.length > 0 ||
          apMCalculateLaborList?.controls?.length > 0
        "
        class="mat-elevation-z0 border-radius-panel"
      >
        <mat-expansion-panel-header class="custom-panel-header">
          <mat-panel-title> MAQMO </mat-panel-title>
        </mat-expansion-panel-header>
        <div class="card-body">
          <h5 class="mt-2 text-center">Validación dimensional</h5>
          <hr class="line" />
          <div class="row card-title d-flex justify-content-between">
            <div class="col-md-6 px-0">
              <h6>Cálculo de mano de obra</h6>
            </div>
            <div class="col-md-6 px-0 text-right">
              <div class="btn-group w-sm-100">
                <button
                  class="btn btn-primary btn-sm"
                  (click)="newCmoList()"
                  type="button"
                >
                  <i class="fas fa-plus"></i>
                </button>
              </div>
            </div>
          </div>
          <ng-container *ngIf="cmoList?.controls?.length; else notData">
            <div class="rounded-top table-responsive">
              <table
                class="table table-bordered table-striped table-sm table-text-small"
              >
                <thead>
                  <tr class="table-primary text-uppercase">
                    <th class="text-center" colspan="4"></th>
                    <th class="text-center" colspan="5" class="text-center">
                      Desplazamiento
                    </th>
                    <th class="text-center" colspan="5" class="text-center">
                      Ordinarias
                    </th>
                    <th class="text-center" colspan="6" class="text-center">
                      Festivas
                    </th>
                    <th></th>
                  </tr>
                </thead>
                <thead>
                  <tr class="text-center text-uppercase table-active">
                    <th class="align-middle">Item</th>
                    <th class="align-middle">Perfil</th>
                    <th class="align-middle">Tipo Desplaza</th>
                    <th class="align-middle">N. Persona</th>
                    <th class="align-middle">N. Días</th>
                    <th class="align-middle">Jornada</th>
                    <th class="align-middle">Horas</th>
                    <th class="align-middle">Valor Horas</th>
                    <th class="align-middle">Valor Total</th>
                    <th class="align-middle">N. Días</th>
                    <th class="align-middle">Jornada</th>
                    <th class="align-middle">Horas</th>
                    <th class="align-middle">Valor Hora</th>
                    <th class="align-middle">Valor Total</th>
                    <th class="align-middle">N. Días</th>
                    <th class="align-middle">Jornada</th>
                    <th class="align-middle">Horas</th>
                    <th class="align-middle">Valor Hora</th>
                    <th class="align-middle">Valor Total</th>
                    <th class="align-middle">Valor Salarial</th>
                    <th><i class="mdi mdi-chevron-down"></i></th>
                  </tr>
                </thead>
                <ng-container formArrayName="calculate_labor">
                  <ng-container
                    *ngFor="let item of cmoList?.controls; let i = index"
                  >
                    <ng-container [formGroupName]="i">
                      <tbody>
                        <tr class="text-center">
                          <td>
                            {{ i + 1 }}
                          </td>
                          <td class="p-0">
                            <select
                              class="form-control form-control-sm form-control-edit form-width"
                              formControlName="apu_profile_id"
                              [class.is-invalid]="
                                item?.get('apu_profile_id')?.invalid
                              "
                            >
                              <option value="" disabled selected hidden>
                                Selecciona
                              </option>
                              <option
                                *ngFor="let item of profiles"
                                [value]="item?.id"
                              >
                                {{ item?.profile }}
                              </option>
                            </select>
                          </td>
                          <td>
                            <select
                              class="form-control form-control-sm form-control-edit form-width"
                              formControlName="displacement_type"
                            >
                              <option value="" disabled selected hidden>
                                Selecciona
                              </option>
                              <option
                                *ngFor="let item of desplazamientos"
                                [value]="item?.value"
                              >
                                {{ item?.text }}
                              </option>
                            </select>
                          </td>
                          <td>
                            <input
                              currencyMask
                              appInputPositionInitial
                              [options]="masksMoney?.maskNumbers"
                              class="form-control form-control-sm form-control-edit"
                              style="width: 3.4rem"
                              formControlName="people_number"
                            />
                          </td>
                          <td>
                            <input
                              currencyMask
                              appInputPositionInitial
                              [options]="masksMoney?.maskNumbers"
                              class="form-control form-control-sm form-control-edit"
                              style="width: 2.5rem"
                              formControlName="days_number_displacement"
                            />
                          </td>
                          <td>
                            <select
                              class="form-control form-control-sm form-control-edit"
                              style="width: 5rem"
                              formControlName="workind_day_displacement"
                            >
                              <option value="" disabled selected hidden>
                                Selecciona
                              </option>
                              <option
                                *ngFor="let item of jornadas"
                                [value]="item?.value"
                              >
                                {{ item?.text }}
                              </option>
                            </select>
                          </td>
                          <td>
                            <input
                              currencyMask
                              appInputPositionInitial
                              [options]="masksMoney?.maskNumbers"
                              class="form-control form-control-sm form-control-edit"
                              style="width: 2.6rem"
                              formControlName="hours_displacement"
                            />
                          </td>
                          <td class="px-2">
                            ${{
                              item?.controls?.hours_value_displacement?.value
                                | number : "1.2-2"
                            }}
                          </td>
                          <td class="px-2">
                            ${{
                              item?.controls?.total_value_displacement?.value
                                | number : "1.2-2"
                            }}
                          </td>
                          <td>
                            <input
                              currencyMask
                              appInputPositionInitial
                              [options]="masksMoney?.maskNumbers"
                              class="form-control form-control-sm form-control-edit"
                              style="width: 2.5rem"
                              formControlName="days_number_ordinary"
                            />
                          </td>
                          <td>
                            <select
                              class="form-control form-control-sm form-control-edit"
                              style="width: 5rem"
                              formControlName="working_day_ordinary"
                            >
                              <option value="" disabled selected hidden>
                                Selecciona
                              </option>
                              <option
                                *ngFor="let item of jornadas"
                                [value]="item?.value"
                              >
                                {{ item?.text }}
                              </option>
                            </select>
                          </td>
                          <td>
                            <input
                              currencyMask
                              appInputPositionInitial
                              [options]="masksMoney?.maskNumbers"
                              class="form-control form-control-sm form-control-edit"
                              style="width: 2.6rem"
                              formControlName="hours_ordinary"
                            />
                          </td>
                          <td class="px-2">
                            ${{
                              item?.controls?.hours_value_ordinary?.value
                                | number : "1.2-2"
                            }}
                          </td>
                          <td class="px-2">
                            ${{
                              item?.controls?.total_value_ordinary?.value
                                | number : "1.2-2"
                            }}
                          </td>
                          <td>
                            <input
                              currencyMask
                              appInputPositionInitial
                              [options]="masksMoney?.maskNumbers"
                              class="form-control form-control-sm form-control-edit"
                              style="width: 2.5rem"
                              formControlName="days_number_festive"
                            />
                          </td>
                          <td>
                            <select
                              class="form-control form-control-sm form-control-edit"
                              style="width: 5rem"
                              formControlName="working_day_festive"
                            >
                              <option value="" disabled selected hidden>
                                Selecciona
                              </option>
                              <option
                                *ngFor="let item of jornadas"
                                [value]="item?.value"
                              >
                                {{ item?.text }}
                              </option>
                            </select>
                          </td>
                          <td>
                            <input
                              currencyMask
                              appInputPositionInitial
                              [options]="masksMoney?.maskNumbers"
                              class="form-control form-control-sm form-control-edit"
                              style="width: 2.6rem"
                              formControlName="hours_festive"
                            />
                          </td>
                          <td class="px-2">
                            ${{
                              item?.controls?.hours_value_festive?.value
                                | number : "1.2-2"
                            }}
                          </td>
                          <td class="px-2">
                            ${{
                              item?.controls?.total_value_festive?.value
                                | number : "1.2-2"
                            }}
                          </td>
                          <td class="px-2">
                            ${{
                              item?.controls?.salary_value?.value
                                | number : "1.2-2"
                            }}
                          </td>
                          <td>
                            <div class="btn-group">
                              <button
                                class="btn btn-outline-danger btn-sm"
                                type="button"
                                (click)="deleteCmoList(i)"
                              >
                                <i class="fas fa-trash-alt"></i>
                              </button>
                            </div>
                          </td>
                        </tr>
                      </tbody>
                    </ng-container>
                  </ng-container>
                </ng-container>
              </table>
            </div>
          </ng-container>
          <ng-container *ngIf="cmoList?.controls?.length">
            <app-list-items
              title1="SUBTOTAL MANO DE OBRA"
              [var1]="this?.form?.get('subtotal_labor')?.value"
              type1="cop"
              mt="mt-2"
            ></app-list-items>
          </ng-container>
          <ng-container *ngIf="cmoList?.controls?.length">
            <h6>Viáticos</h6>
            <ng-container formArrayName="calculate_labor">
              <div class="row">
                <ng-container
                  *ngFor="let item of cmoList?.controls; let i = index"
                >
                  <ng-container [formGroupName]="i">
                    <div class="col-md-4">
                      <div class="rounded-top table-responsive">
                        <table
                          class="table table-borderless table-striped table-sm travel-table"
                        >
                          <thead>
                            <tr class="table-primary text-uppercase">
                              <th class="text-center">Perfil {{ i + 1 }}</th>
                              <th class="text-center">
                                {{ getProfileName(item) }}
                              </th>
                              <th colspan="3" class="text-center">Viáticos</th>
                            </tr>
                          </thead>
                          <thead class="bg-light">
                            <tr class="text-center text-uppercase">
                              <th>Descripción</th>
                              <th>Unidad</th>
                              <th>Cantidad</th>
                              <th>Valor Unitario</th>
                              <th>Total</th>
                            </tr>
                          </thead>
                          <tbody formArrayName="viatic_estimation">
                            <ng-container
                              *ngFor="
                                let item of item?.controls?.viatic_estimation
                                  ?.controls;
                                let j = index
                              "
                            >
                              <tr [formGroupName]="j">
                                <td class="text-center">
                                  {{
                                    item?.controls?.description?.value
                                      | uppercase
                                  }}
                                </td>
                                <td class="text-center">
                                  {{ item?.controls?.unit?.value | uppercase }}
                                </td>
                                <td>
                                  <input
                                    currencyMask
                                    appInputPositionInitial
                                    [options]="masksMoney?.maskNumbers3Decimal"
                                    placeholder="Cantidad"
                                    class="form-control form-control-sm form-control-travel"
                                    formControlName="amount"
                                  />
                                </td>
                                <td class="text-right">
                                  <input
                                    currencyMask
                                    appInputPosition
                                    [options]="masksMoney?.maskCOP"
                                    placeholder="Valor unitario"
                                    class="form-control form-control-sm form-control-travel"
                                    formControlName="unit_value"
                                  />
                                  <!-- ${{
                                    item?.controls?.unit_value?.value
                                      | number : "1.2-2"
                                  }} -->
                                </td>
                                <td class="text-right">
                                  ${{
                                    item?.controls?.total_value?.value
                                      | number : "1.2-2"
                                  }}
                                </td>
                              </tr>
                            </ng-container>
                          </tbody>
                          <tr class="table-primary">
                            <th
                              style="font-size: 0.8rem !important"
                              colspan="4"
                              class="text-right pr-0"
                            >
                              SUBTOTAL
                            </th>
                            <th
                              style="font-size: 0.8rem !important"
                              class="text-right pr-0"
                            >
                              ${{
                                item?.controls?.subtotal?.value
                                  | number : "1.2-2"
                              }}
                            </th>
                          </tr>
                        </table>
                      </div>
                    </div>
                  </ng-container>
                </ng-container>
              </div>
            </ng-container>
            <app-list-items
              title1="SUBTOTAL VIÁTICOS"
              [var1]="this?.form?.get('subtotal_travel_expense')?.value"
              type1="cop"
              title2="SUBTOTAL VALIDACIÓN DIMENSIONAL"
              [var2]="this?.form?.get('subtotal_dimensional_validation')?.value"
              type2="cop"
              mt="mt-2"
            ></app-list-items>
          </ng-container>
          <hr />
          <h5 class="text-center">Montaje de equipos</h5>
          <hr class="line" />
          <div class="row card-title d-flex justify-content-between">
            <div class="col-md-6 px-0">
              <h6>Cálculo de mano de obra</h6>
            </div>
            <div class="col-md-6 px-0 text-right">
              <div class="btn-group w-sm-100">
                <button
                  class="btn btn-primary btn-sm"
                  type="button"
                  (click)="newmpMCalculateLaborList()"
                >
                  <i class="fas fa-plus"></i>
                </button>
              </div>
            </div>
          </div>
          <!-- mpm es porque antes era montaje y puesta en marcha pero ahora es montaje de equipos -->
          <ng-container
            *ngIf="mpMCalculateLaborList?.controls?.length; else notData"
          >
            <div class="rounded-top table-responsive">
              <table
                class="table table-bordered table-striped table-sm table-text-small"
              >
                <thead>
                  <tr class="table-primary text-uppercase">
                    <th colspan="4"></th>
                    <th colspan="5" class="text-center">Desplazamiento</th>
                    <th colspan="5" class="text-center">Ordinarias</th>
                    <th colspan="6" class="text-center">Festivas</th>
                    <th></th>
                  </tr>
                </thead>
                <thead class="bg-light">
                  <tr class="text-center text-uppercase table-active">
                    <th class="align-middle">Item</th>
                    <th class="align-middle">Perfil</th>
                    <th class="align-middle">Tipo Desplaza</th>
                    <th class="align-middle">N. Persona</th>
                    <th class="align-middle">N. Días</th>
                    <th class="align-middle">Jornada</th>
                    <th class="align-middle">Horas</th>
                    <th class="align-middle">Valor Horas</th>
                    <th class="align-middle">Valor Total</th>
                    <th class="align-middle">N. Días</th>
                    <th class="align-middle">Jornada</th>
                    <th class="align-middle">Horas</th>
                    <th class="align-middle">Valor Hora</th>
                    <th class="align-middle">Valor Total</th>
                    <th class="align-middle">N. Días</th>
                    <th class="align-middle">Jornada</th>
                    <th class="align-middle">Horas</th>
                    <th class="align-middle">Valor Hora</th>
                    <th class="align-middle">Valor Total</th>
                    <th class="align-middle">Valor Salarial</th>
                    <th><i class="mdi mdi-chevron-down"></i></th>
                  </tr>
                </thead>
                <ng-container formArrayName="mpm_calculate_labor">
                  <ng-container
                    *ngFor="
                      let item of mpMCalculateLaborList?.controls;
                      let i = index
                    "
                  >
                    <ng-container [formGroupName]="i">
                      <tbody>
                        <tr>
                          <td class="text-center">
                            {{ i + 1 }}
                          </td>
                          <td>
                            <select
                              class="form-control form-control-sm form-control-edit form-width"
                              formControlName="apu_profile_id"
                            >
                              <option value="" disabled selected hidden>
                                Selecciona
                              </option>
                              <option
                                *ngFor="let item of profiles"
                                [value]="item?.id"
                              >
                                {{ item?.profile }}
                              </option>
                            </select>
                          </td>
                          <td>
                            <select
                              class="form-control form-control-sm form-control-edit form-width"
                              formControlName="displacement_type"
                            >
                              <option value="" disabled selected hidden>
                                Selecciona
                              </option>
                              <option
                                *ngFor="let item of desplazamientos"
                                [value]="item?.value"
                              >
                                {{ item?.text }}
                              </option>
                            </select>
                          </td>
                          <td>
                            <input
                              currencyMask
                              appInputPositionInitial
                              [options]="masksMoney?.maskNumbers"
                              class="form-control form-control-sm form-control-edit"
                              style="width: 3.4rem"
                              formControlName="people_number"
                            />
                          </td>
                          <td>
                            <input
                              currencyMask
                              appInputPositionInitial
                              [options]="masksMoney?.maskNumbers"
                              class="form-control form-control-sm form-control-edit"
                              style="width: 2.5rem"
                              formControlName="days_number_displacement"
                            />
                          </td>
                          <td>
                            <select
                              class="form-control form-control-sm form-control-edit"
                              style="width: 5rem"
                              formControlName="workind_day_displacement"
                            >
                              <option value="" disabled selected hidden>
                                Selecciona
                              </option>
                              <option
                                *ngFor="let item of jornadas"
                                [value]="item?.value"
                              >
                                {{ item?.text }}
                              </option>
                            </select>
                          </td>
                          <td>
                            <input
                              currencyMask
                              appInputPositionInitial
                              [options]="masksMoney?.maskNumbers"
                              class="form-control form-control-sm form-control-edit"
                              style="width: 2.6rem"
                              formControlName="hours_displacement"
                            />
                          </td>
                          <td class="text-right px-2">
                            ${{
                              item?.controls?.hours_value_displacement?.value
                                | number : "1.2-2"
                            }}
                          </td>
                          <td class="text-right px-2">
                            ${{
                              item?.controls?.total_value_displacement?.value
                                | number : "1.2-2"
                            }}
                          </td>
                          <td>
                            <input
                              currencyMask
                              appInputPositionInitial
                              [options]="masksMoney?.maskNumbers"
                              class="form-control form-control-sm form-control-edit"
                              style="width: 2.5rem"
                              formControlName="days_number_ordinary"
                            />
                          </td>
                          <td>
                            <select
                              class="form-control form-control-sm form-control-edit"
                              style="width: 5rem"
                              formControlName="working_day_ordinary"
                            >
                              <option value="" disabled selected hidden>
                                Selecciona
                              </option>
                              <option
                                *ngFor="let item of jornadas"
                                [value]="item?.value"
                              >
                                {{ item?.text }}
                              </option>
                            </select>
                          </td>
                          <td>
                            <input
                              currencyMask
                              appInputPositionInitial
                              [options]="masksMoney?.maskNumbers"
                              class="form-control form-control-sm form-control-edit"
                              style="width: 2.6rem"
                              formControlName="hours_ordinary"
                            />
                          </td>
                          <td class="text-right px-2">
                            ${{
                              item?.controls?.hours_value_ordinary?.value
                                | number : "1.2-2"
                            }}
                          </td>
                          <td class="text-right px-2">
                            ${{
                              item?.controls?.total_value_ordinary?.value
                                | number : "1.2-2"
                            }}
                          </td>
                          <td>
                            <input
                              currencyMask
                              appInputPositionInitial
                              [options]="masksMoney?.maskNumbers"
                              class="form-control form-control-sm form-control-edit"
                              style="width: 2.5rem"
                              formControlName="days_number_festive"
                            />
                          </td>
                          <td>
                            <select
                              class="form-control form-control-sm form-control-edit"
                              style="width: 5rem"
                              formControlName="working_day_festive"
                            >
                              <option value="" disabled selected hidden>
                                Selecciona
                              </option>
                              <option
                                *ngFor="let item of jornadas"
                                [value]="item?.value"
                              >
                                {{ item?.text }}
                              </option>
                            </select>
                          </td>
                          <td>
                            <input
                              currencyMask
                              appInputPositionInitial
                              [options]="masksMoney?.maskNumbers"
                              class="form-control form-control-sm form-control-edit"
                              style="width: 2.6rem"
                              formControlName="hours_festive"
                            />
                          </td>
                          <td class="text-right px-2">
                            ${{
                              item?.controls?.hours_value_festive?.value
                                | number : "1.2-2"
                            }}
                          </td>
                          <td class="text-right px-2">
                            ${{
                              item?.controls?.total_value_festive?.value
                                | number : "1.2-2"
                            }}
                          </td>
                          <td class="text-right px-2">
                            ${{
                              item?.controls?.salary_value?.value
                                | number : "1.2-2"
                            }}
                          </td>
                          <td class="text-center">
                            <button
                              class="btn btn-outline-danger btn-sm"
                              type="button"
                              (click)="deletempMCalculateLaborList(i)"
                            >
                              <i class="fas fa-trash-alt"></i>
                            </button>
                          </td>
                        </tr>
                      </tbody>
                    </ng-container>
                  </ng-container>
                </ng-container>
              </table>
            </div>
          </ng-container>
          <ng-container *ngIf="mpMCalculateLaborList?.controls?.length">
            <app-list-items
              title1="SUBTOTAL MANO DE OBRA"
              [var1]="this?.form?.get('subtotal_labor_mpm')?.value"
              type1="cop"
              mt="mt-2"
            ></app-list-items>
          </ng-container>
          <ng-container *ngIf="mpMCalculateLaborList?.controls?.length">
            <h6>Viáticos</h6>
            <ng-container formArrayName="mpm_calculate_labor">
              <div class="row">
                <ng-container
                  *ngFor="
                    let item of mpMCalculateLaborList?.controls;
                    let i = index
                  "
                >
                  <ng-container [formGroupName]="i">
                    <div class="col-md-4">
                      <div class="rounded-top table-responsive">
                        <table
                          class="table table-borderless table-striped table-sm travel-table"
                        >
                          <thead>
                            <tr class="table-primary text-uppercase">
                              <th class="text-center">Perfil {{ i + 1 }}</th>
                              <th class="text-center">
                                {{ getProfileName(item) }}
                              </th>
                              <th colspan="3" class="text-center">Viáticos</th>
                            </tr>
                          </thead>
                          <thead class="bg-light">
                            <tr class="text-center text-uppercase">
                              <th>Descripción</th>
                              <th>Unidad</th>
                              <th>Cantidad</th>
                              <th>Valor Unitario</th>
                              <th>Total</th>
                            </tr>
                          </thead>
                          <tbody formArrayName="viatic_estimation">
                            <ng-container
                              *ngFor="
                                let item of item?.controls?.viatic_estimation
                                  ?.controls;
                                let j = index
                              "
                            >
                              <tr [formGroupName]="j">
                                <td class="text-center">
                                  {{
                                    item?.controls?.description?.value
                                      | uppercase
                                  }}
                                </td>
                                <td class="text-center">
                                  {{ item?.controls?.unit?.value | uppercase }}
                                </td>
                                <td>
                                  <input
                                    currencyMask
                                    appInputPositionInitial
                                    [options]="masksMoney?.maskNumbers3Decimal"
                                    placeholder="Cantidad"
                                    class="form-control form-control-sm form-control-travel"
                                    formControlName="amount"
                                  />
                                </td>
                                <td class="text-right">
                                  <input
                                    currencyMask
                                    appInputPosition
                                    [options]="masksMoney?.maskCOP"
                                    placeholder="Valor unitario"
                                    class="form-control form-control-sm form-control-travel"
                                    formControlName="unit_value"
                                  />
                                  <!-- ${{
                                    item?.controls?.unit_value?.value
                                      | number : "1.2-2"
                                  }} -->
                                </td>
                                <td class="text-right">
                                  ${{
                                    item?.controls?.total_value?.value
                                      | number : "1.2-2"
                                  }}
                                </td>
                              </tr>
                            </ng-container>
                          </tbody>
                          <tr class="table-primary">
                            <th
                              style="font-size: 0.8rem !important"
                              colspan="4"
                              class="text-right pr-0"
                            >
                              SUBTOTAL
                            </th>
                            <th
                              style="font-size: 0.8rem !important"
                              class="text-right pr-0"
                            >
                              ${{
                                item?.controls?.subtotal?.value
                                  | number : "1.2-2"
                              }}
                            </th>
                          </tr>
                        </table>
                      </div>
                    </div>
                  </ng-container>
                </ng-container>
              </div>
            </ng-container>
          </ng-container>

          <ng-container *ngIf="mpMCalculateLaborList?.controls?.length">
            <app-list-items
              title1="SUBTOTAL VIÁTICOS"
              [var1]="this?.form?.get('subtotal_travel_expense_mpm')?.value"
              type1="cop"
              title2="SUBTOTAL MONTAJE EQUIPOS"
              [var2]="this?.form?.get('subtotal_assembly_commissioning')?.value"
              type2="cop"
              mt="mt-2"
            ></app-list-items>
          </ng-container>
          <hr />
          <h5 class="text-center">Acompañamiento y puesta en marcha</h5>
          <hr class="line" />
          <div class="row card-title d-flex justify-content-between">
            <div class="col-md-6 px-0">
              <h6>Cálculo de mano de obra</h6>
            </div>
            <div class="col-md-6 px-0 text-right">
              <div class="btn-group w-sm-100">
                <button
                  class="btn btn-primary btn-sm"
                  type="button"
                  (click)="newapMCalculateLaborList()"
                >
                  <i class="fas fa-plus"></i>
                </button>
              </div>
            </div>
          </div>
          <!-- mpm es porque antes era montaje y puesta en marcha pero ahora es montaje de equipos -->
          <ng-container
            *ngIf="apMCalculateLaborList?.controls?.length; else notData"
          >
            <div class="rounded-top table-responsive">
              <table
                class="table table-bordered table-striped table-sm table-text-small"
              >
                <thead>
                  <tr class="table-primary text-uppercase">
                    <th colspan="4"></th>
                    <th colspan="5" class="text-center">Desplazamiento</th>
                    <th colspan="5" class="text-center">Ordinarias</th>
                    <th colspan="6" class="text-center">Festivas</th>
                    <th></th>
                  </tr>
                </thead>
                <thead class="bg-light">
                  <tr class="text-center text-uppercase table-active">
                    <th class="align-middle">Item</th>
                    <th class="align-middle">Perfil</th>
                    <th class="align-middle">Tipo Desplaza</th>
                    <th class="align-middle">N. Persona</th>
                    <th class="align-middle">N. Días</th>
                    <th class="align-middle">Jornada</th>
                    <th class="align-middle">Horas</th>
                    <th class="align-middle">Valor Horas</th>
                    <th class="align-middle">Valor Total</th>
                    <th class="align-middle">N. Días</th>
                    <th class="align-middle">Jornada</th>
                    <th class="align-middle">Horas</th>
                    <th class="align-middle">Valor Hora</th>
                    <th class="align-middle">Valor Total</th>
                    <th class="align-middle">N. Días</th>
                    <th class="align-middle">Jornada</th>
                    <th class="align-middle">Horas</th>
                    <th class="align-middle">Valor Hora</th>
                    <th class="align-middle">Valor Total</th>
                    <th class="align-middle">Valor Salarial</th>
                    <th><i class="mdi mdi-chevron-down"></i></th>
                  </tr>
                </thead>
                <ng-container formArrayName="apm_calculate_labor">
                  <ng-container
                    *ngFor="
                      let item of apMCalculateLaborList?.controls;
                      let i = index
                    "
                  >
                    <ng-container [formGroupName]="i">
                      <tbody>
                        <tr>
                          <td class="text-center">
                            {{ i + 1 }}
                          </td>
                          <td>
                            <select
                              class="form-control form-control-sm form-control-edit form-width"
                              formControlName="apu_profile_id"
                            >
                              <option value="" disabled selected hidden>
                                Selecciona
                              </option>
                              <option
                                *ngFor="let item of profiles"
                                [value]="item?.id"
                              >
                                {{ item?.profile }}
                              </option>
                            </select>
                          </td>
                          <td>
                            <select
                              class="form-control form-control-sm form-control-edit form-width"
                              formControlName="displacement_type"
                            >
                              <option value="" disabled selected hidden>
                                Selecciona
                              </option>
                              <option
                                *ngFor="let item of desplazamientos"
                                [value]="item?.value"
                              >
                                {{ item?.text }}
                              </option>
                            </select>
                          </td>
                          <td>
                            <input
                              currencyMask
                              appInputPositionInitial
                              [options]="masksMoney?.maskNumbers"
                              class="form-control form-control-sm form-control-edit"
                              style="width: 3.4rem"
                              formControlName="people_number"
                            />
                          </td>
                          <td>
                            <input
                              currencyMask
                              appInputPositionInitial
                              [options]="masksMoney?.maskNumbers"
                              class="form-control form-control-sm form-control-edit"
                              style="width: 2.5rem"
                              formControlName="days_number_displacement"
                            />
                          </td>
                          <td>
                            <select
                              class="form-control form-control-sm form-control-edit"
                              style="width: 5rem"
                              formControlName="workind_day_displacement"
                            >
                              <option value="" disabled selected hidden>
                                Selecciona
                              </option>
                              <option
                                *ngFor="let item of jornadas"
                                [value]="item?.value"
                              >
                                {{ item?.text }}
                              </option>
                            </select>
                          </td>
                          <td>
                            <input
                              currencyMask
                              appInputPositionInitial
                              [options]="masksMoney?.maskNumbers"
                              class="form-control form-control-sm form-control-edit"
                              style="width: 2.6rem"
                              formControlName="hours_displacement"
                            />
                          </td>
                          <td class="text-right px-2">
                            ${{
                              item?.controls?.hours_value_displacement?.value
                                | number : "1.2-2"
                            }}
                          </td>
                          <td class="text-right px-2">
                            ${{
                              item?.controls?.total_value_displacement?.value
                                | number : "1.2-2"
                            }}
                          </td>
                          <td>
                            <input
                              currencyMask
                              appInputPositionInitial
                              [options]="masksMoney?.maskNumbers"
                              class="form-control form-control-sm form-control-edit"
                              style="width: 2.5rem"
                              formControlName="days_number_ordinary"
                            />
                          </td>
                          <td>
                            <select
                              class="form-control form-control-sm form-control-edit"
                              style="width: 5rem"
                              formControlName="working_day_ordinary"
                            >
                              <option value="" disabled selected hidden>
                                Selecciona
                              </option>
                              <option
                                *ngFor="let item of jornadas"
                                [value]="item?.value"
                              >
                                {{ item?.text }}
                              </option>
                            </select>
                          </td>
                          <td>
                            <input
                              currencyMask
                              appInputPositionInitial
                              [options]="masksMoney?.maskNumbers"
                              class="form-control form-control-sm form-control-edit"
                              style="width: 2.6rem"
                              formControlName="hours_ordinary"
                            />
                          </td>
                          <td class="text-right px-2">
                            ${{
                              item?.controls?.hours_value_ordinary?.value
                                | number : "1.2-2"
                            }}
                          </td>
                          <td class="text-right px-2">
                            ${{
                              item?.controls?.total_value_ordinary?.value
                                | number : "1.2-2"
                            }}
                          </td>
                          <td>
                            <input
                              currencyMask
                              appInputPositionInitial
                              [options]="masksMoney?.maskNumbers"
                              class="form-control form-control-sm form-control-edit"
                              style="width: 2.5rem"
                              formControlName="days_number_festive"
                            />
                          </td>
                          <td>
                            <select
                              class="form-control form-control-sm form-control-edit"
                              style="width: 5rem"
                              formControlName="working_day_festive"
                            >
                              <option value="" disabled selected hidden>
                                Selecciona
                              </option>
                              <option
                                *ngFor="let item of jornadas"
                                [value]="item?.value"
                              >
                                {{ item?.text }}
                              </option>
                            </select>
                          </td>
                          <td>
                            <input
                              currencyMask
                              appInputPositionInitial
                              [options]="masksMoney?.maskNumbers"
                              class="form-control form-control-sm form-control-edit"
                              style="width: 2.6rem"
                              formControlName="hours_festive"
                            />
                          </td>
                          <td class="text-right px-2">
                            ${{
                              item?.controls?.hours_value_festive?.value
                                | number : "1.2-2"
                            }}
                          </td>
                          <td class="text-right px-2">
                            ${{
                              item?.controls?.total_value_festive?.value
                                | number : "1.2-2"
                            }}
                          </td>
                          <td class="text-right px-2">
                            ${{
                              item?.controls?.salary_value?.value
                                | number : "1.2-2"
                            }}
                          </td>
                          <td class="text-center">
                            <button
                              class="btn btn-outline-danger btn-sm"
                              type="button"
                              (click)="deleteapMCalculateLaborList(i)"
                            >
                              <i class="fas fa-trash-alt"></i>
                            </button>
                          </td>
                        </tr>
                      </tbody>
                    </ng-container>
                  </ng-container>
                </ng-container>
              </table>
            </div>
          </ng-container>
          <ng-container *ngIf="apMCalculateLaborList?.controls?.length">
            <app-list-items
              title1="SUBTOTAL MANO DE OBRA"
              [var1]="this?.form?.get('subtotal_labor_apm')?.value"
              type1="cop"
              mt="mt-2"
            ></app-list-items>
          </ng-container>

          <ng-container *ngIf="apMCalculateLaborList?.controls?.length">
            <h6>Viáticos</h6>
            <ng-container formArrayName="apm_calculate_labor">
              <div class="row">
                <ng-container
                  *ngFor="
                    let item of apMCalculateLaborList?.controls;
                    let i = index
                  "
                >
                  <ng-container [formGroupName]="i">
                    <div class="col-md-4">
                      <div class="rounded-top table-responsive">
                        <table
                          class="table table-borderless table-striped table-sm travel-table"
                        >
                          <thead>
                            <tr class="table-primary text-uppercase">
                              <th class="text-center">Perfil {{ i + 1 }}</th>
                              <th class="text-center">
                                {{ getProfileName(item) }}
                              </th>
                              <th colspan="3" class="text-center">Viáticos</th>
                            </tr>
                          </thead>
                          <thead class="bg-light">
                            <tr class="text-center text-uppercase">
                              <th>Descripción</th>
                              <th>Unidad</th>
                              <th>Cantidad</th>
                              <th>Valor Unitario</th>
                              <th>Total</th>
                            </tr>
                          </thead>
                          <tbody formArrayName="viatic_estimation">
                            <ng-container
                              *ngFor="
                                let item of item?.controls?.viatic_estimation
                                  ?.controls;
                                let j = index
                              "
                            >
                              <tr [formGroupName]="j">
                                <td class="text-center">
                                  {{
                                    item?.controls?.description?.value
                                      | uppercase
                                  }}
                                </td>
                                <td class="text-center">
                                  {{ item?.controls?.unit?.value | uppercase }}
                                </td>
                                <td>
                                  <input
                                    currencyMask
                                    appInputPositionInitial
                                    [options]="masksMoney?.maskNumbers3Decimal"
                                    placeholder="Cantidad"
                                    class="form-control form-control-sm form-control-travel"
                                    formControlName="amount"
                                  />
                                </td>
                                <td class="text-right">
                                  <input
                                    currencyMask
                                    appInputPosition
                                    [options]="masksMoney?.maskCOP"
                                    placeholder="Valor unitario"
                                    class="form-control form-control-sm form-control-travel"
                                    formControlName="unit_value"
                                  />
                                  <!-- ${{
                                    item?.controls?.unit_value?.value
                                      | number : "1.2-2"
                                  }} -->
                                </td>
                                <td class="text-right">
                                  ${{
                                    item?.controls?.total_value?.value
                                      | number : "1.2-2"
                                  }}
                                </td>
                              </tr>
                            </ng-container>
                          </tbody>
                          <tr class="table-primary">
                            <th
                              style="font-size: 0.8rem !important"
                              colspan="4"
                              class="text-right pr-0"
                            >
                              SUBTOTAL
                            </th>
                            <th
                              style="font-size: 0.8rem !important"
                              class="text-right pr-0"
                            >
                              ${{
                                item?.controls?.subtotal?.value
                                  | number : "1.2-2"
                              }}
                            </th>
                          </tr>
                        </table>
                      </div>
                    </div>
                  </ng-container>
                </ng-container>
              </div>
            </ng-container>
          </ng-container>

          <ng-container *ngIf="apMCalculateLaborList?.controls?.length">
            <app-list-items
              title1="SUBTOTAL VIÁTICOS"
              [var1]="this?.form?.get('subtotal_travel_expense_apm')?.value"
              type1="cop"
              title2="SUBTOTAL ACOMPAÑAMIENTO"
              [var2]="this?.form?.get('subtotal_accompaniment')?.value"
              type2="cop"
              mt="mt-2"
            ></app-list-items>
          </ng-container>
          <hr />
          <app-list-items
            title1="SUBTOTAL GENERAL VIÁTICOS + MANO DE OBRA"
            [var1]="
              this?.form?.get('general_subtotal_travel_expense_labor')?.value
            "
            type1="cop"
            mt="mt-2"
          ></app-list-items>
        </div>
      </mat-expansion-panel>
      <mat-expansion-panel
        [expanded]="
          cVdCalculateLaborList?.controls?.length > 0 ||
          cMeCalculateLaborList?.controls?.length > 0 ||
          cApMCalculateLaborList?.controls?.length > 0
        "
        class="mat-elevation-z0 border-radius-panel"
      >
        <mat-expansion-panel-header class="custom-panel-header">
          <mat-panel-title> CONTRATISTAS </mat-panel-title>
        </mat-expansion-panel-header>
        <div class="card-body">
          <h5 class="text-center">Validación dimensional</h5>
          <hr class="line" />
          <div class="row card-title d-flex justify-content-between">
            <div class="col-md-6 px-0">
              <h6>Cálculo de mano de obra</h6>
            </div>
            <div class="col-md-6 px-0 text-right">
              <div class="btn-group w-sm-100">
                <button
                  class="btn btn-primary btn-sm"
                  type="button"
                  (click)="newCVdMCalculateLaborList()"
                >
                  <i class="fas fa-plus"></i>
                </button>
              </div>
            </div>
          </div>
          <ng-container
            *ngIf="cVdCalculateLaborList?.controls?.length; else notData"
          >
            <div class="rounded-top table-responsive">
              <table
                class="table table-bordered table-striped table-sm table-text-small"
              >
                <thead>
                  <tr class="table-primary text-uppercase">
                    <th colspan="4"></th>
                    <th colspan="3" class="text-center">Desplazamiento</th>
                    <th colspan="3" class="text-center">Ordinarias</th>
                    <th colspan="3" class="text-center">Festivas</th>
                    <th></th>
                  </tr>
                </thead>
                <thead class="bg-light">
                  <tr class="text-center text-uppercase table-active">
                    <th class="align-middle">Item</th>
                    <th class="align-middle">Perfil</th>
                    <th class="align-middle">Tipo Desplaza</th>
                    <th class="align-middle">N. Persona</th>
                    <th class="align-middle">N. Días</th>
                    <th class="align-middle">Jornada</th>
                    <th class="align-middle">Horas</th>
                    <th class="align-middle">N. Días</th>
                    <th class="align-middle">Jornada</th>
                    <th class="align-middle">Horas</th>
                    <th class="align-middle">N. Días</th>
                    <th class="align-middle">Jornada</th>
                    <th class="align-middle">Horas</th>
                    <th><i class="mdi mdi-chevron-down"></i></th>
                  </tr>
                </thead>
                <ng-container formArrayName="c_vd_calculate_labor">
                  <ng-container
                    *ngFor="
                      let item of cVdCalculateLaborList?.controls;
                      let i = index
                    "
                  >
                    <ng-container [formGroupName]="i">
                      <tbody>
                        <tr>
                          <td class="text-center">
                            {{ i + 1 }}
                          </td>
                          <td>
                            <select
                              class="form-control form-control-sm form-control-edit"
                              formControlName="apu_profile_id"
                            >
                              <option value="" disabled selected hidden>
                                Selecciona
                              </option>
                              <option
                                *ngFor="let item of profiles"
                                [value]="item?.id"
                              >
                                {{ item?.profile }}
                              </option>
                            </select>
                          </td>
                          <td>
                            <select
                              class="form-control form-control-sm form-control-edit"
                              formControlName="displacement_type"
                            >
                              <option value="" disabled selected hidden>
                                Selecciona
                              </option>
                              <option
                                *ngFor="let item of desplazamientos"
                                [value]="item?.value"
                              >
                                {{ item?.text }}
                              </option>
                            </select>
                          </td>
                          <td>
                            <input
                              currencyMask
                              appInputPositionInitial
                              [options]="masksMoney?.maskNumbers"
                              class="form-control form-control-sm form-control-edit"
                              formControlName="people_number"
                            />
                          </td>
                          <td>
                            <input
                              currencyMask
                              appInputPositionInitial
                              [options]="masksMoney?.maskNumbers"
                              class="form-control form-control-sm form-control-edit"
                              formControlName="days_number_displacement"
                            />
                          </td>
                          <td>
                            <select
                              class="form-control form-control-sm form-control-edit"
                              formControlName="workind_day_displacement"
                            >
                              <option value="" disabled selected hidden>
                                Selecciona
                              </option>
                              <option
                                *ngFor="let item of jornadas"
                                [value]="item?.value"
                              >
                                {{ item?.text }}
                              </option>
                            </select>
                          </td>
                          <td>
                            <input
                              currencyMask
                              appInputPositionInitial
                              [options]="masksMoney?.maskNumbers"
                              class="form-control form-control-sm form-control-edit"
                              formControlName="hours_displacement"
                            />
                          </td>
                          <td>
                            <input
                              currencyMask
                              appInputPositionInitial
                              [options]="masksMoney?.maskNumbers"
                              class="form-control form-control-sm form-control-edit"
                              formControlName="days_number_ordinary"
                            />
                          </td>
                          <td>
                            <select
                              class="form-control form-control-sm form-control-edit"
                              formControlName="working_day_ordinary"
                            >
                              <option value="" disabled selected hidden>
                                Selecciona
                              </option>
                              <option
                                *ngFor="let item of jornadas"
                                [value]="item?.value"
                              >
                                {{ item?.text }}
                              </option>
                            </select>
                          </td>
                          <td>
                            <input
                              currencyMask
                              appInputPositionInitial
                              [options]="masksMoney?.maskNumbers"
                              class="form-control form-control-sm form-control-edit"
                              formControlName="hours_ordinary"
                            />
                          </td>
                          <td>
                            <input
                              currencyMask
                              appInputPositionInitial
                              [options]="masksMoney?.maskNumbers"
                              class="form-control form-control-sm form-control-edit"
                              formControlName="days_number_festive"
                            />
                          </td>
                          <td>
                            <select
                              class="form-control form-control-sm form-control-edit"
                              formControlName="working_day_festive"
                            >
                              <option value="" disabled selected hidden>
                                Selecciona
                              </option>
                              <option
                                *ngFor="let item of jornadas"
                                [value]="item?.value"
                              >
                                {{ item?.text }}
                              </option>
                            </select>
                          </td>
                          <td>
                            <input
                              currencyMask
                              appInputPositionInitial
                              [options]="masksMoney?.maskNumbers"
                              class="form-control form-control-sm form-control-edit"
                              formControlName="hours_festive"
                            />
                          </td>
                          <td class="text-center">
                            <button
                              class="btn btn-outline-danger btn-sm"
                              type="button"
                              (click)="deleteCVdCalculateLaborList(i)"
                            >
                              <i class="fas fa-trash-alt"></i>
                            </button>
                          </td>
                        </tr>
                      </tbody>
                    </ng-container>
                  </ng-container>
                </ng-container>
              </table>
            </div>
          </ng-container>
          <ng-container *ngIf="cVdCalculateLaborList?.controls?.length">
            <h6>Viáticos</h6>
            <ng-container formArrayName="c_vd_calculate_labor">
              <div class="row">
                <ng-container
                  *ngFor="
                    let item of cVdCalculateLaborList?.controls;
                    let i = index
                  "
                >
                  <ng-container [formGroupName]="i">
                    <div class="col-md-4">
                      <div class="rounded-top table-responsive">
                        <table
                          class="table table-borderless table-striped table-sm travel-table"
                        >
                          <thead>
                            <tr class="table-primary text-uppercase">
                              <th class="text-center">Perfil {{ i + 1 }}</th>
                              <th class="text-center">
                                {{ getProfileName(item) }}
                              </th>
                              <th colspan="3" class="text-center">Viáticos</th>
                            </tr>
                          </thead>
                          <thead class="bg-light">
                            <tr class="text-center text-uppercase">
                              <th>Descripción</th>
                              <th>Unidad</th>
                              <th>Cantidad</th>
                              <th>Valor Unitario</th>
                              <th>Total</th>
                            </tr>
                          </thead>
                          <tbody formArrayName="viatic_estimation">
                            <ng-container
                              *ngFor="
                                let item of item?.controls?.viatic_estimation
                                  ?.controls;
                                let j = index
                              "
                            >
                              <tr [formGroupName]="j">
                                <td class="text-center">
                                  {{
                                    item?.controls?.description?.value
                                      | uppercase
                                  }}
                                </td>
                                <td class="text-center">
                                  {{ item?.controls?.unit?.value | uppercase }}
                                </td>
                                <td>
                                  <input
                                    currencyMask
                                    appInputPositionInitial
                                    [options]="masksMoney?.maskNumbers3Decimal"
                                    placeholder="Cantidad"
                                    class="form-control form-control-sm form-control-travel"
                                    formControlName="amount"
                                  />
                                </td>
                                <td class="text-right">
                                  <input
                                    currencyMask
                                    appInputPosition
                                    [options]="masksMoney?.maskCOP"
                                    placeholder="Valor unitario"
                                    class="form-control form-control-sm form-control-travel"
                                    formControlName="unit_value"
                                  />
                                </td>
                                <td class="text-right">
                                  ${{
                                    item?.controls?.total_value?.value
                                      | number : "1.2-2"
                                  }}
                                </td>
                              </tr>
                            </ng-container>
                          </tbody>
                          <tr class="table-primary">
                            <th
                              style="font-size: 0.8rem !important"
                              colspan="4"
                              class="text-right pr-0"
                            >
                              SUBTOTAL
                            </th>
                            <th
                              style="font-size: 0.8rem !important"
                              class="text-right pr-0"
                            >
                              ${{
                                item?.controls?.subtotal?.value
                                  | number : "1.2-2"
                              }}
                            </th>
                          </tr>
                        </table>
                      </div>
                    </div>
                  </ng-container>
                </ng-container>
              </div>
            </ng-container>
          </ng-container>
          <ng-container *ngIf="cVdCalculateLaborList?.controls?.length">
            <app-list-items
              title1="SUBTOTAL VIÁTICOS"
              [var1]="this?.form?.get('subtotal_travel_expense_vd_c')?.value"
              type1="cop"
              title2="SUBTOTAL VALIDACIÓN DIMENSIONAL"
              [var2]="
                this?.form?.get('subtotal_dimensional_validation_c')?.value
              "
              type2="cop"
              mt="mt-2"
            ></app-list-items>
          </ng-container>
          <hr />
          <h5 class="text-center">Montaje de equipos</h5>
          <hr class="line" />
          <div class="row card-title d-flex justify-content-between">
            <div class="col-md-6 px-0">
              <h6>Cálculo de mano de obra</h6>
            </div>
            <div class="col-md-6 px-0 text-right">
              <div class="btn-group w-sm-100">
                <button
                  class="btn btn-primary btn-sm"
                  type="button"
                  (click)="newCMeCalculateLaborList()"
                >
                  <i class="fas fa-plus"></i>
                </button>
              </div>
            </div>
          </div>
          <ng-container
            *ngIf="cMeCalculateLaborList?.controls?.length; else notData"
          >
            <div class="rounded-top table-responsive">
              <table
                class="table table-bordered table-striped table-sm table-text-small"
              >
                <thead>
                  <tr class="table-primary text-uppercase">
                    <th colspan="4"></th>
                    <th colspan="3" class="text-center">Desplazamiento</th>
                    <th colspan="3" class="text-center">Ordinarias</th>
                    <th colspan="3" class="text-center">Festivas</th>
                    <th></th>
                  </tr>
                </thead>
                <thead class="bg-light">
                  <tr class="text-center text-uppercase table-active">
                    <th class="align-middle">Item</th>
                    <th class="align-middle">Perfil</th>
                    <th class="align-middle">Tipo Desplaza</th>
                    <th class="align-middle">N. Persona</th>
                    <th class="align-middle">N. Días</th>
                    <th class="align-middle">Jornada</th>
                    <th class="align-middle">Horas</th>
                    <th class="align-middle">N. Días</th>
                    <th class="align-middle">Jornada</th>
                    <th class="align-middle">Horas</th>
                    <th class="align-middle">N. Días</th>
                    <th class="align-middle">Jornada</th>
                    <th class="align-middle">Horas</th>
                    <th><i class="mdi mdi-chevron-down"></i></th>
                  </tr>
                </thead>
                <ng-container formArrayName="c_me_calculate_labor">
                  <ng-container
                    *ngFor="
                      let item of cMeCalculateLaborList?.controls;
                      let i = index
                    "
                  >
                    <ng-container [formGroupName]="i">
                      <tbody>
                        <tr>
                          <td class="text-center">
                            {{ i + 1 }}
                          </td>
                          <td>
                            <select
                              class="form-control form-control-sm form-control-edit"
                              formControlName="apu_profile_id"
                            >
                              <option value="" disabled selected hidden>
                                Selecciona
                              </option>
                              <option
                                *ngFor="let item of profiles"
                                [value]="item?.id"
                              >
                                {{ item?.profile }}
                              </option>
                            </select>
                          </td>
                          <td>
                            <select
                              class="form-control form-control-sm form-control-edit"
                              formControlName="displacement_type"
                            >
                              <option value="" disabled selected hidden>
                                Selecciona
                              </option>
                              <option
                                *ngFor="let item of desplazamientos"
                                [value]="item?.value"
                              >
                                {{ item?.text }}
                              </option>
                            </select>
                          </td>
                          <td>
                            <input
                              currencyMask
                              appInputPositionInitial
                              [options]="masksMoney?.maskNumbers"
                              class="form-control form-control-sm form-control-edit"
                              formControlName="people_number"
                            />
                          </td>
                          <td>
                            <input
                              currencyMask
                              appInputPositionInitial
                              [options]="masksMoney?.maskNumbers"
                              class="form-control form-control-sm form-control-edit"
                              formControlName="days_number_displacement"
                            />
                          </td>
                          <td>
                            <select
                              class="form-control form-control-sm form-control-edit"
                              formControlName="workind_day_displacement"
                            >
                              <option value="" disabled selected hidden>
                                Selecciona
                              </option>
                              <option
                                *ngFor="let item of jornadas"
                                [value]="item?.value"
                              >
                                {{ item?.text }}
                              </option>
                            </select>
                          </td>
                          <td>
                            <input
                              currencyMask
                              appInputPositionInitial
                              [options]="masksMoney?.maskNumbers"
                              class="form-control form-control-sm form-control-edit"
                              formControlName="hours_displacement"
                            />
                          </td>
                          <td>
                            <input
                              currencyMask
                              appInputPositionInitial
                              [options]="masksMoney?.maskNumbers"
                              class="form-control form-control-sm form-control-edit"
                              formControlName="days_number_ordinary"
                            />
                          </td>
                          <td>
                            <select
                              class="form-control form-control-sm form-control-edit"
                              formControlName="working_day_ordinary"
                            >
                              <option value="" disabled selected hidden>
                                Selecciona
                              </option>
                              <option
                                *ngFor="let item of jornadas"
                                [value]="item?.value"
                              >
                                {{ item?.text }}
                              </option>
                            </select>
                          </td>
                          <td>
                            <input
                              currencyMask
                              appInputPositionInitial
                              [options]="masksMoney?.maskNumbers"
                              class="form-control form-control-sm form-control-edit"
                              formControlName="hours_ordinary"
                            />
                          </td>
                          <td>
                            <input
                              currencyMask
                              appInputPositionInitial
                              [options]="masksMoney?.maskNumbers"
                              class="form-control form-control-sm form-control-edit"
                              formControlName="days_number_festive"
                            />
                          </td>
                          <td>
                            <select
                              class="form-control form-control-sm form-control-edit"
                              formControlName="working_day_festive"
                            >
                              <option value="" disabled selected hidden>
                                Selecciona
                              </option>
                              <option
                                *ngFor="let item of jornadas"
                                [value]="item?.value"
                              >
                                {{ item?.text }}
                              </option>
                            </select>
                          </td>
                          <td>
                            <input
                              currencyMask
                              appInputPositionInitial
                              [options]="masksMoney?.maskNumbers"
                              class="form-control form-control-sm form-control-edit"
                              formControlName="hours_festive"
                            />
                          </td>
                          <td class="text-center">
                            <button
                              class="btn btn-outline-danger btn-sm"
                              type="button"
                              (click)="deleteCMeCalculateLaborList(i)"
                            >
                              <i class="fas fa-trash-alt"></i>
                            </button>
                          </td>
                        </tr>
                      </tbody>
                    </ng-container>
                  </ng-container>
                </ng-container>
              </table>
            </div>
          </ng-container>
          <ng-container *ngIf="cMeCalculateLaborList?.controls?.length">
            <h6>Viáticos</h6>
            <ng-container formArrayName="c_me_calculate_labor">
              <div class="row">
                <ng-container
                  *ngFor="
                    let item of cMeCalculateLaborList?.controls;
                    let i = index
                  "
                >
                  <ng-container [formGroupName]="i">
                    <div class="col-md-4">
                      <div class="rounded-top table-responsive">
                        <table
                          class="table table-borderless table-striped table-sm travel-table"
                        >
                          <thead>
                            <tr class="table-primary text-uppercase">
                              <th class="text-center">Perfil {{ i + 1 }}</th>
                              <th class="text-center">
                                {{ getProfileName(item) }}
                              </th>
                              <th colspan="3" class="text-center">Viáticos</th>
                            </tr>
                          </thead>
                          <thead class="bg-light">
                            <tr class="text-center text-uppercase">
                              <th>Descripción</th>
                              <th>Unidad</th>
                              <th>Cantidad</th>
                              <th>Valor Unitario</th>
                              <th>Total</th>
                            </tr>
                          </thead>
                          <tbody formArrayName="viatic_estimation">
                            <ng-container
                              *ngFor="
                                let item of item?.controls?.viatic_estimation
                                  ?.controls;
                                let j = index
                              "
                            >
                              <tr [formGroupName]="j">
                                <td class="text-center">
                                  {{
                                    item?.controls?.description?.value
                                      | uppercase
                                  }}
                                </td>
                                <td class="text-center">
                                  {{ item?.controls?.unit?.value | uppercase }}
                                </td>
                                <td>
                                  <input
                                    currencyMask
                                    appInputPositionInitial
                                    [options]="masksMoney?.maskNumbers3Decimal"
                                    placeholder="Cantidad"
                                    class="form-control form-control-sm form-control-travel"
                                    formControlName="amount"
                                  />
                                </td>
                                <td class="text-right">
                                  <input
                                    currencyMask
                                    appInputPosition
                                    [options]="masksMoney?.maskCOP"
                                    placeholder="Valor unitario"
                                    class="form-control form-control-sm form-control-travel"
                                    formControlName="unit_value"
                                  />
                                </td>
                                <td class="text-right">
                                  ${{
                                    item?.controls?.total_value?.value
                                      | number : "1.2-2"
                                  }}
                                </td>
                              </tr>
                            </ng-container>
                          </tbody>
                          <tr class="table-primary">
                            <th
                              style="font-size: 0.8rem !important"
                              colspan="4"
                              class="text-right pr-0"
                            >
                              SUBTOTAL
                            </th>
                            <th
                              style="font-size: 0.8rem !important"
                              class="text-right pr-0"
                            >
                              ${{
                                item?.controls?.subtotal?.value
                                  | number : "1.2-2"
                              }}
                            </th>
                          </tr>
                        </table>
                      </div>
                    </div>
                  </ng-container>
                </ng-container>
              </div>
            </ng-container>
          </ng-container>
          <ng-container *ngIf="cMeCalculateLaborList?.controls?.length">
            <app-list-items
              title1="SUBTOTAL VIÁTICOS"
              [var1]="this?.form?.get('subtotal_travel_expense_me_c')?.value"
              type1="cop"
              title2="SUBTOTAL MONTAJE EQUIPOS"
              [var2]="this?.form?.get('subtotal_assembly_c')?.value"
              type2="cop"
              mt="mt-2"
            ></app-list-items>
          </ng-container>
          <hr />
          <h5 class="text-center">Acompañamiento y puesta en marcha</h5>
          <hr class="line" />
          <div class="row card-title d-flex justify-content-between">
            <div class="col-md-6 px-0">
              <h6>Cálculo de mano de obra</h6>
            </div>
            <div class="col-md-6 px-0 text-right">
              <div class="btn-group w-sm-100">
                <button
                  class="btn btn-primary btn-sm"
                  type="button"
                  (click)="newCApMCalculateLaborList()"
                >
                  <i class="fas fa-plus"></i>
                </button>
              </div>
            </div>
          </div>
          <!-- mpm es porque antes era montaje y puesta en marcha pero ahora es montaje de equipos -->
          <ng-container
            *ngIf="cApMCalculateLaborList?.controls?.length; else notData"
          >
            <div class="rounded-top table-responsive">
              <table
                class="table table-bordered table-striped table-sm table-text-small"
              >
                <thead>
                  <tr class="table-primary text-uppercase">
                    <th colspan="4"></th>
                    <th colspan="3" class="text-center">Desplazamiento</th>
                    <th colspan="3" class="text-center">Ordinarias</th>
                    <th colspan="3" class="text-center">Festivas</th>
                    <th></th>
                  </tr>
                </thead>
                <thead class="bg-light">
                  <tr class="text-center text-uppercase table-active">
                    <th class="align-middle">Item</th>
                    <th class="align-middle">Perfil</th>
                    <th class="align-middle">Tipo Desplaza</th>
                    <th class="align-middle">N. Persona</th>
                    <th class="align-middle">N. Días</th>
                    <th class="align-middle">Jornada</th>
                    <th class="align-middle">Horas</th>
                    <th class="align-middle">N. Días</th>
                    <th class="align-middle">Jornada</th>
                    <th class="align-middle">Horas</th>
                    <th class="align-middle">N. Días</th>
                    <th class="align-middle">Jornada</th>
                    <th class="align-middle">Horas</th>
                    <th><i class="mdi mdi-chevron-down"></i></th>
                  </tr>
                </thead>
                <ng-container formArrayName="c_apm_calculate_labor">
                  <ng-container
                    *ngFor="
                      let item of cApMCalculateLaborList?.controls;
                      let i = index
                    "
                  >
                    <ng-container [formGroupName]="i">
                      <tbody>
                        <tr>
                          <td class="text-center">
                            {{ i + 1 }}
                          </td>
                          <td>
                            <select
                              class="form-control form-control-sm form-control-edit"
                              formControlName="apu_profile_id"
                            >
                              <option value="" disabled selected hidden>
                                Selecciona
                              </option>
                              <option
                                *ngFor="let item of profiles"
                                [value]="item?.id"
                              >
                                {{ item?.profile }}
                              </option>
                            </select>
                          </td>
                          <td>
                            <select
                              class="form-control form-control-sm form-control-edit"
                              formControlName="displacement_type"
                            >
                              <option value="" disabled selected hidden>
                                Selecciona
                              </option>
                              <option
                                *ngFor="let item of desplazamientos"
                                [value]="item?.value"
                              >
                                {{ item?.text }}
                              </option>
                            </select>
                          </td>
                          <td>
                            <input
                              currencyMask
                              appInputPositionInitial
                              [options]="masksMoney?.maskNumbers"
                              class="form-control form-control-sm form-control-edit"
                              formControlName="people_number"
                            />
                          </td>
                          <td>
                            <input
                              currencyMask
                              appInputPositionInitial
                              [options]="masksMoney?.maskNumbers"
                              class="form-control form-control-sm form-control-edit"
                              formControlName="days_number_displacement"
                            />
                          </td>
                          <td>
                            <select
                              class="form-control form-control-sm form-control-edit"
                              formControlName="workind_day_displacement"
                            >
                              <option value="" disabled selected hidden>
                                Selecciona
                              </option>
                              <option
                                *ngFor="let item of jornadas"
                                [value]="item?.value"
                              >
                                {{ item?.text }}
                              </option>
                            </select>
                          </td>
                          <td>
                            <input
                              currencyMask
                              appInputPositionInitial
                              [options]="masksMoney?.maskNumbers"
                              class="form-control form-control-sm form-control-edit"
                              formControlName="hours_displacement"
                            />
                          </td>
                          <td>
                            <input
                              currencyMask
                              appInputPositionInitial
                              [options]="masksMoney?.maskNumbers"
                              class="form-control form-control-sm form-control-edit"
                              formControlName="days_number_ordinary"
                            />
                          </td>
                          <td>
                            <select
                              class="form-control form-control-sm form-control-edit"
                              formControlName="working_day_ordinary"
                            >
                              <option value="" disabled selected hidden>
                                Selecciona
                              </option>
                              <option
                                *ngFor="let item of jornadas"
                                [value]="item?.value"
                              >
                                {{ item?.text }}
                              </option>
                            </select>
                          </td>
                          <td>
                            <input
                              currencyMask
                              appInputPositionInitial
                              [options]="masksMoney?.maskNumbers"
                              class="form-control form-control-sm form-control-edit"
                              formControlName="hours_ordinary"
                            />
                          </td>
                          <td>
                            <input
                              currencyMask
                              appInputPositionInitial
                              [options]="masksMoney?.maskNumbers"
                              class="form-control form-control-sm form-control-edit"
                              formControlName="days_number_festive"
                            />
                          </td>
                          <td>
                            <select
                              class="form-control form-control-sm form-control-edit"
                              formControlName="working_day_festive"
                            >
                              <option value="" disabled selected hidden>
                                Selecciona
                              </option>
                              <option
                                *ngFor="let item of jornadas"
                                [value]="item?.value"
                              >
                                {{ item?.text }}
                              </option>
                            </select>
                          </td>
                          <td>
                            <input
                              currencyMask
                              appInputPositionInitial
                              [options]="masksMoney?.maskNumbers"
                              class="form-control form-control-sm form-control-edit"
                              formControlName="hours_festive"
                            />
                          </td>
                          <td class="text-center">
                            <button
                              class="btn btn-outline-danger btn-sm"
                              type="button"
                              (click)="deleteCApMCalculateLaborList(i)"
                            >
                              <i class="fas fa-trash-alt"></i>
                            </button>
                          </td>
                        </tr>
                      </tbody>
                    </ng-container>
                  </ng-container>
                </ng-container>
              </table>
            </div>
          </ng-container>
          <ng-container *ngIf="cApMCalculateLaborList?.controls?.length">
            <h6>Viáticos</h6>
            <ng-container formArrayName="c_apm_calculate_labor">
              <div class="row">
                <ng-container
                  *ngFor="
                    let item of cApMCalculateLaborList?.controls;
                    let i = index
                  "
                >
                  <ng-container [formGroupName]="i">
                    <div class="col-md-4">
                      <div class="rounded-top table-responsive">
                        <table
                          class="table table-borderless table-striped table-sm travel-table"
                        >
                          <thead>
                            <tr class="table-primary text-uppercase">
                              <th class="text-center">Perfil {{ i + 1 }}</th>
                              <th class="text-center">
                                {{ getProfileName(item) }}
                              </th>
                              <th colspan="3" class="text-center">Viáticos</th>
                            </tr>
                          </thead>
                          <thead class="bg-light">
                            <tr class="text-center text-uppercase">
                              <th>Descripción</th>
                              <th>Unidad</th>
                              <th>Cantidad</th>
                              <th>Valor Unitario</th>
                              <th>Total</th>
                            </tr>
                          </thead>
                          <tbody formArrayName="viatic_estimation">
                            <ng-container
                              *ngFor="
                                let item of item?.controls?.viatic_estimation
                                  ?.controls;
                                let j = index
                              "
                            >
                              <tr [formGroupName]="j">
                                <td class="text-center">
                                  {{
                                    item?.controls?.description?.value
                                      | uppercase
                                  }}
                                </td>
                                <td class="text-center">
                                  {{ item?.controls?.unit?.value | uppercase }}
                                </td>
                                <td>
                                  <input
                                    currencyMask
                                    appInputPositionInitial
                                    [options]="masksMoney?.maskNumbers3Decimal"
                                    placeholder="Cantidad"
                                    class="form-control form-control-sm form-control-travel"
                                    formControlName="amount"
                                  />
                                </td>
                                <td class="text-right">
                                  <input
                                    currencyMask
                                    appInputPosition
                                    [options]="masksMoney?.maskCOP"
                                    placeholder="Valor unitario"
                                    class="form-control form-control-sm form-control-travel"
                                    formControlName="unit_value"
                                  />
                                </td>
                                <td class="text-right">
                                  ${{
                                    item?.controls?.total_value?.value
                                      | number : "1.2-2"
                                  }}
                                </td>
                              </tr>
                            </ng-container>
                          </tbody>
                          <tr class="table-primary">
                            <th
                              style="font-size: 0.8rem !important"
                              colspan="4"
                              class="text-right pr-0"
                            >
                              SUBTOTAL
                            </th>
                            <th
                              style="font-size: 0.8rem !important"
                              class="text-right pr-0"
                            >
                              ${{
                                item?.controls?.subtotal?.value
                                  | number : "1.2-2"
                              }}
                            </th>
                          </tr>
                        </table>
                      </div>
                    </div>
                  </ng-container>
                </ng-container>
              </div>
            </ng-container>
          </ng-container>
          <ng-container *ngIf="cApMCalculateLaborList?.controls?.length">
            <app-list-items
              title1="SUBTOTAL VIÁTICOS"
              [var1]="this?.form?.get('subtotal_travel_expense_apm_c')?.value"
              type1="cop"
              title2="SUBTOTAL ACOMPAÑAMIENTO"
              [var2]="this?.form?.get('subtotal_accompaniment_c')?.value"
              type2="cop"
              mt="mt-2"
            ></app-list-items>
          </ng-container>
          <hr />
          <app-list-items
            title1="SUBTOTAL GENERAL VIÁTICOS + MANO DE OBRA"
            [var1]="
              this?.form?.get('general_subtotal_travel_expense_labor_c')?.value
            "
            type1="cop"
            mt="mt-2"
          ></app-list-items>
        </div>
      </mat-expansion-panel>
    </mat-accordion>
    <div class="card col-md-6 mx-auto mt-4">
      <div class="card-body">
        <h5 class="text-center">AIU</h5>
        <hr class="line" />
        <div class="d-flex justify-content-center">
          <div class="rounded-top table-responsive">
            <table class="table table-borderless">
              <tbody class="text-uppercase">
                <tr>
                  <td colspan="2">Subtotal maqmo</td>
                  <td class="text-right">
                    ${{
                      this?.form?.get("general_subtotal_travel_expense_labor")
                        ?.value | number : "1.2-2"
                    }}
                  </td>
                </tr>
                <tr>
                  <td colspan="2">Subtotal contratistas</td>
                  <td class="text-right">
                    ${{
                      this?.form?.get("general_subtotal_travel_expense_labor_c")
                        ?.value | number : "1.2-2"
                    }}
                  </td>
                </tr>
                <tr class="table-primary">
                  <th colspan="2">Maqmo + Contratistas</th>
                  <th class="text-right">
                    ${{
                      this?.form?.get("total_unit_cost")?.value
                        | number : "1.2-2"
                    }}
                  </th>
                </tr>
                <tr>
                  <td class="col-7">Administrativos</td>
                  <td class="col-2">
                    <input
                      currencyMask
                      appInputPositionInitial
                      [options]="masksMoney?.maskPorcentaje"
                      class="form-control form-control-sm"
                      formControlName="administrative_percentage"
                    />
                  </td>
                  <td class="col-3 text-right">
                    ${{
                      form?.controls?.administrative_value?.value
                        | number : "1.2-2"
                    }}
                  </td>
                </tr>
                <tr>
                  <td class="col-7">Imprevistos</td>
                  <td class="col-2">
                    <input
                      currencyMask
                      appInputPositionInitial
                      [options]="masksMoney?.maskPorcentaje"
                      class="form-control form-control-sm"
                      formControlName="unforeseen_percentage"
                    />
                  </td>
                  <td class="col-3 text-right">
                    ${{
                      form?.controls?.unforeseen_value?.value | number : "1.2-2"
                    }}
                  </td>
                </tr>
                <tr>
                  <td class="col-9" colspan="2">Subtotal A + I</td>
                  <td class="col-3 text-right">
                    ${{
                      form?.controls?.subtotal_administrative_unforeseen?.value
                        | number : "1.2-2"
                    }}
                  </td>
                </tr>
                <tr>
                  <td class="col-9" colspan="2">Utilidad</td>
                  <td class="col-3">
                    <input
                      currencyMask
                      appInputPositionInitial
                      [options]="masksMoney?.maskPorcentaje"
                      class="form-control form-control-sm"
                      formControlName="utility_percentage"
                    />
                  </td>
                </tr>
                <tr>
                  <td class="col-9" colspan="2">SubTotal A + I + U</td>
                  <td class="col-3 text-right">
                    ${{
                      form?.controls?.subtotal_administrative_unforeseen_utility
                        ?.value | number : "1.2-2"
                    }}
                  </td>
                </tr>
                <tr class="table-primary">
                  <th class="col-9 align-middle" colspan="2">
                    Precio venta COP incluye retención
                  </th>
                  <th class="col-3 align-middle text-right">
                    $
                    {{
                      form?.get("sale_price_cop_withholding_total")?.value
                        | number : "1.2-2"
                    }}
                  </th>
                </tr>
                <tr>
                  <td class="col-9" colspan="2">TRM</td>
                  <td class="col-3">
                    <input
                      currencyMask
                      appInputPosition
                      [options]="masksMoney?.maskCOP"
                      class="form-control form-control-sm"
                      formControlName="trm"
                    />
                  </td>
                </tr>
                <tr class="table-primary">
                  <th class="col-9 align-middle" colspan="2">
                    Precio venta USD incluye retención
                  </th>
                  <th class="col-3 align-middle text-right">
                    USD
                    {{
                      form?.get("sale_price_usd_withholding_total")?.value
                        | number : "1.2-2"
                    }}
                  </th>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
    <button
      class="btn btn-block btn-primary mb-3"
      *ngIf="!preData"
      (click)="save()"
    >
      Guardar
    </button>
  </form>
</ng-container>
<ng-template #notData>
  <div class="alert alert-warning text-center" role="alert">
    ¡No hay datos aquí!
  </div>
</ng-template>
<ng-template #notDataL>
  <div class="card">
    <div class="card-body">
      <app-not-data [loading]="loading"></app-not-data>
    </div>
  </div>
</ng-template>

<app-reload-button
  [reload]="reload"
  (reloadData)="reloadData()"
></app-reload-button>
