<div class="card">
  <ng-container *ngIf="!loading; else notDataL">
    <div class="card-body">
      <div class="card-title d-flex justify-content-between">
        <h4 class="text-primary">APU Pieza - {{ data.name }}</h4>
        <span>
          {{ data.created_at | date: "EEEE, MMMM d, y" | titlecase }} -
          Bucaramanga - Colombia
        </span>
      </div>
      <hr class="line" />
      <div class="row">
        <div class="col-md-6">
          <table class="table table-borderless">
            <tbody>
              <tr>
                <th scope="row">Nombre</th>
                <td>{{ data.name }}</td>
              </tr>
              <tr>
                <th scope="row">Destino</th>
                <td>{{ data.city.name }}</td>
              </tr>
              <tr>
                <th scope="row">Quién elabora</th>
                <td>
                  {{ data.person.name }}
                </td>
              </tr>
            </tbody>
          </table>
        </div>
        <div class="col-md-6">
          <table class="table table-borderless">
            <tbody>
              <tr>
                <th scope="row">Cliente</th>
                <td>
                  {{ data.thirdparty.name }}
                </td>
              </tr>
              <tr>
                <th scope="row">Línea</th>
                <td>{{ data.line }}</td>
              </tr>
              <tr>
                <th scope="row">Observaciones</th>
                <td>
                  {{ data.observation }}
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      <hr />
      <h5 class="mt-2 text-center">Validación Dimensional</h5>
      <hr />
      <h6>Cálculo de mano de obra</h6>
      <perfect-scrollbar>
        <div
          class="col"
          style="overflow-x: auto"
          class="items table-responsive"
        >
          <app-validacion-dimensional
            *ngIf="data.dimensional_validation.length"
            [data]="data.dimensional_validation"
          ></app-validacion-dimensional>
        </div>
      </perfect-scrollbar>
      <div class="row d-flex justify-content-end mt-3">
        <div class="col-md-3">
          <div class="d-flex justify-content-between">
            <label>Subtotal mano de obra:</label>
            <span>{{ data.subtotal_labor }}</span>
          </div>
          <div class="d-flex justify-content-between">
            <label>SubTotal Viáticos:</label>
            <span>{{ data.subtotal_travel_expense }}</span>
          </div>
          <div class="d-flex justify-content-between">
            <label>Subtotal Valid. Dimensional:</label>
            <span>{{ data.subtotal_dimensional_validation }}</span>
          </div>
        </div>
      </div>
      <hr />
      <h5 class="text-center">Montaje y Puesta en Marcha</h5>
      <hr />
      <h6>Cálculo de mano de obra</h6>
      <perfect-scrollbar>
        <div
          class="col"
          style="overflow-x: auto"
          class="items table-responsive"
        >
          <app-montaje-puesta-marcha
            *ngIf="data.assemblies_start_up.length"
            [data]="data.assemblies_start_up"
          ></app-montaje-puesta-marcha>
        </div>
      </perfect-scrollbar>
      <div class="row d-flex justify-content-end mt-3">
        <div class="col-md-3">
          <div class="d-flex justify-content-between">
            <label>Subtotal mano de obra:</label>
            <span>{{ data.subtotal_labor_mpm }}</span>
          </div>
          <div class="d-flex justify-content-between">
            <label>Subtotal Viáticos:</label>
            <span>{{ data.subtotal_travel_expense_mpm }}</span>
          </div>
          <div class="d-flex justify-content-between">
            <label>Subtotal Montaje y Puesta en marcha:</label>
            <span>{{ data.subtotal_assembly_commissioning }}</span>
          </div>
          <div class="d-flex justify-content-between">
            <label>Subtotal general Viáticos + Mano de obra:</label>
            <span>{{ data.general_subtotal_travel_expense_labor }}</span>
          </div>
        </div>
      </div>
      <hr>
      <h4 class="text-center">AIU</h4>
      <hr>
      <div class="row d-flex justify-content-center">
        <div class="col-md-5">
          <table class="table table-striped">
            <tbody class="bg-light">
              <tr>
                <td>
                  <label class="col-form-label col-form-label-sm"
                    >Administrativos</label
                  >
                </td>
                <td>
                  {{ data.administrative_percentage }}
                </td>
                <td>
                  {{ data.administrative_value }}
                </td>
              </tr>
              <tr>
                <td>
                  <label class="col-form-label col-form-label-sm"
                    >Imprevistos</label
                  >
                </td>
                <td>
                  {{ data.unforeseen_percentage }}
                </td>
                <td>
                  {{ data.unforeseen_value }}
                </td>
              </tr>
              <tr>
                <td colspan="2">
                  <label class="col-form-label col-form-label-sm"
                    >Subtotal A + I</label
                  >
                </td>
                <td>
                  {{ data.subtotal_administrative_unforeseen }}
                </td>
              </tr>
              <tr>
                <td colspan="2">
                  <label class="col-form-label col-form-label-sm"
                    >Utilidad</label
                  >
                </td>
                <td>
                  {{ data.utility_percentage }}
                </td>
              </tr>
              <tr>
                <td colspan="2">
                  <label class="col-form-label col-form-label-sm"
                    >SubTotal A + I + U</label
                  >
                </td>
                <td>
                  {{ data.subtotal_administrative_unforeseen_utility }}
                </td>
              </tr>
              <tr>
                <td colspan="2">
                  <label class="col-form-label col-form-label-sm"
                    >Precio Venta COP Incluye retención</label
                  >
                </td>
                <td>
                  {{ data.sale_price_cop_withholding_total }}
                </td>
              </tr>
              <tr>
                <td colspan="2">
                  <label class="col-form-label col-form-label-sm">TRM</label>
                </td>
                <td>
                  {{ data.trm }}
                </td>
              </tr>
              <tr>
                <td colspan="2">
                  <label class="col-form-label col-form-label-sm"
                    >Precio Venta USD Incluye retención</label
                  >
                </td>
                <td>
                  {{ data.sale_price_usd_withholding_total }}
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      <button class="btn btn-block btn-primary">Descargar</button>
    </div>
  </ng-container>
</div>

<ng-template #notDataL>
  <app-not-data [loading]="loading"></app-not-data>
</ng-template>
<ng-template #notData>
  <tr class="bg-light">
    <td colspan="100%" class="text-center">
      <p class="text-dark">Sin datos agregados</p>
    </td>
  </tr>
</ng-template>
