<div class="ngbNavContent text-center">
  <ng-container *ngIf="!loading && tareas.length > 0; else notData">
    <div
      class="card mt-3"
      *ngFor="let task of tareas; let i = index"
      style="box-shadow: 0px 0px 5px 5px rgb(0 0 0 / 8%)"
    >
      <div class="card-body py-1">
        <div class="d-flex justify-content-between">
          <i *ngIf="!task.completed" class="pt-1 fa fa-clock"></i>
          <i *ngIf="task.completed" class="pt-1 fa fa-check-circle"></i>
          <span class="card-text">
            {{
              task.description.length > 30
                ? (task.description | slice: 0:30) + "..."
                : task.description
            }}
          </span>
          <!-- <h5 class="card-title">{{ task.responsable | slice:0:20 }}</h5> -->
          <i
            role="button"
            class="pt-1 fa fa-external-link-alt"
            (click)="editTask(task, add)"
          ></i>
        </div>
      </div>
    </div>
  </ng-container>
  <div class="d-flex justify-content-end">
    <button class="btn btn-sm btn-primary" (click)="openModal()">
      <i class="fa fa-plus"></i>
    </button>
  </div>
</div>

<app-new-task [open]="open.asObservable()"></app-new-task>
<ng-template #notData>
  <app-not-data [loading]="loading"></app-not-data>
</ng-template>
<ng-template #add let-modal>
  <div class="modal-header">
    <h4 class="text-primary modal-title">Nueva tarea</h4>
    <button
      type="button"
      class="close"
      data-dismiss="modal"
      aria-label="Close"
      (click)="modal.dismiss('Cross click')"
    >
      <span aria-hidden="true">&times;</span>
    </button>
  </div>
  <div class="modal-body">
    <form [formGroup]="form" class="text-center">
      <input type="hidden" formControlName="business_budget_id" />
      <ng-select
        formControlName="person_id"
        [items]="peopleSelects"
        bindLabel="text"
        appearance="outline"
        [appendTo]="'body'"
        placeholder="Responsable"
        bindValue="value"
        loadingText="loading"
      >
      </ng-select>
      <mat-form-field
        class="col-md-12 p-0 mat-form-field-no-padding textarea mt-3"
        appearance="outline"
      >
        <mat-label>Descripción</mat-label>
        <textarea
          matInput
          placeholder="Ingrese la descripción"
          rows="5"
          formControlName="description"
          id="description"
          name="description"
          required
          [cdkTextareaAutosize]="true"
        ></textarea>
      </mat-form-field>
      <!-- (change)="permit.Activo = !permit.Activo" -->
      <div class="custom-switch mt-2" dir="ltr ">
        <input
          type="checkbox"
          class="custom-control-input"
          formControlName="completed"
          id="input"
        />
        <label class="custom-control-label" for="input">Terminado</label>
      </div>
    </form>
  </div>
  <div class="modal-footer">
    <button
      type="button"
      class="btn btn-danger"
      (click)="modal.dismiss('Cross click')"
    >
      Cancelar
    </button>
    <button
      type="submit"
      class="btn btn-primary"
      [disabled]="!form.valid"
      (click)="saveTask()"
    >
      Guardar
    </button>
  </div>
</ng-template>
