<div class="card">
    <div class="card-header">
        <div class="card-title mt-3 text-center">
            <h5>Negocios</h5>
        </div>
    </div>
    <div class="card-body">
        <div class="row ml-0 mr-0" style="border-top: solid black">
            <div class="col-md-2 mt-3 mb-3">
                <img [src]="negocio?.third_party.image | image" alt="Logo para la empresa" style="max-width: -webkit-fill-available" />
            </div>
            <div class="col-md-2 mt-3">
                <label>{{ negocio?.code }}</label>
                <p class="d-block m-0">{{ negocio?.country.name }}</p>
                <p class="d-block m-0">{{ negocio?.date | date }}</p>
                <p class="d-block m-0">{{ negocio?.third_party.first_name ? negocio?.third_party.first_name + " " + negocio?.third_party.first_surname : negocio?.third_party.social_reason }}</p>
                <p class="d-block m-0">{{ negocio?.third_party_person.name }}</p>
            </div>
            <div class="col-md-6 mt-3">
                <label for="" class="d-block">Detalles</label>
                <p class="text-justify">{{ negocio?.description }}</p>
            </div>
            <div class="col-md-2 mt-3 mb-3">
                <!-- <img [src]="negocio.qr " alt="qrNegocio" style="max-width: -webkit-fill-available" /> -->
            </div>
        </div>
        <div class="row mr-0 ml-0" style="border-top: solid black">
            <div class="col-md-8 mt-3">
                <div>
                    <h6>Presupuestos</h6>
                    <table class="table table-bordered">
                        <thead class="table-dark text-center">
                            <th class="col-md-8">Descripción</th>
                            <th class="col-md-2">Fecha</th>
                            <th class="col-md-2">Valor</th>
                        </thead>
                        <tbody style="font-weight: 100">
                            <tr *ngFor="let pres of negocio?.business_budget">
                                <td scope="row">{{ pres?.budget.observation }}</td>
                                <td>{{ pres?.budget.created_at | date }}</td>
                                <td>$ {{ pres?.budget.total_cop | number }}</td>
                            </tr>
                            <tr>
                                <td scope="row" colspan="2"><strong>Agregar Presupuesto(s)</strong></td>
                                <td class="text-center btn btn-success btn-block" role="button" (click)="addPresupuesto()">
                                    <i class="fa fa-plus"></i>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <div>
                    <!-- <h6>Cotizaciones</h6>
                    <table class="table table-bordered">
                        <thead class="table-dark text-center">
                            <th class="col-md-8">Descripción</th>
                            <th class="col-md-2">Fecha</th>
                            <th class="col-md-2">Valor</th>
                        </thead>
                        <tbody style="font-weight: 100">
                            <tr *ngFor="let coti of negocio.cotizaciones">
                                <td scope="row">{{ coti.descripcion }}</td>
                                <td>{{ coti.fecha | date }}</td>
                                <td>$ {{ coti.valor | number }}</td>
                            </tr>
                            <tr>
                                <td scope="row" colspan="2"><strong>Agregar Cotizacion(es)</strong></td>
                                <td class="text-center btn btn-success btn-block" role="button" (click)="addCotizacion(); modalPresupuestos.show()">
                                    <i class="fa fa-plus"></i>
                                </td>
                            </tr>
                        </tbody>
                    </table> -->
                </div>
            </div>
            <div class="col-md-4" style="border-left: solid black">
                <ul ngbNav #nav="ngbNav" [(activeId)]="active" class="nav-tabs nav-pills  mt-2">
                    <li [ngbNavItem]="2">
                        <a ngbNavLink>Tareas</a>
                        <ng-template ngbNavContent>
                            <app-tareas-negocio [tareas]="tareas" [business_budget_id]="business_budget_id"  (updateListTask)="updateListTask($event)">
                            </app-tareas-negocio>
                        </ng-template>
                    </li>
                    <li [ngbNavItem]="1">
                        <a ngbNavLink>History</a>
                        <ng-template ngbNavContent>
                            <div class="text-center">
                                <app-historial-negocio></app-historial-negocio>
                            </div>
                        </ng-template>
                    </li>
                </ul>
                <div [ngbNavOutlet]="nav" class="mt-2"></div>
            </div>
        </div>
    </div>
</div>
<app-modal-basic #modalPresupuestos [dialogClass]="'modal-lg'">
    <div class="app-modal-header">
        <h5 class="modal-title">Seleccionar Presupuestos disponibles</h5>
        <button type="button" class="close basic-close" (click)="modalPresupuestos.hide()">
      <span aria-hidden="true">
        <i class="fas fa-times" (click)="modalPresupuestos.hide()"></i>
        </span>
        </button>
    </div>
    <div class="app-modal-body">
        <table class="mt-2 table table-borderless table-striped">
            <thead>
                <tr>
                    <th>Item</th>
                    <th>Fecha</th>
                    <th>Cliente</th>
                    <th>Destino</th>
                    <th>Linea</th>
                    <th>Quien elabora</th>
                    <th>Total COP</th>
                    <th>Total USD</th>
                </tr>
            </thead>
            <tbody>
                <tr *ngFor="let item of presupuestos" [ngClass]="{'bg-danger text-white': ( item.state == 'Inactivo' )}">
                    <td>
                        <input type="checkbox" (change)="guardarPresupuesto(item.id, item.total_cop)"/>
                        <label [for]=" item.id " class="ml-1 "> PRES {{ item.id }} </label>
                    </td>
                    <td> {{ item.created_at | date:'dd-MM-YYYY' }} </td>
                    <td> {{ item.customer.name }} </td>
                    <td> {{ item.destiny.name }} </td>
                    <td> {{ item.line }} </td>
                    <td> {{ item.user.person.first_name }} {{ item.user.person.first_surname }} </td>
                    <td> ${{ item.total_cop | currency:'':'' }} </td>
                    <td> ${{ item.total_usd | currency:'':'' }} </td>
                </tr>
            </tbody>
        </table>
        <!-- <ng-select [items]="dataModal " bindLabel="descripcion " [multiple]="true " [closeOnSelect]="false " [selectableGroup]="true " [selectableGroupAsModel]="false " [(ngModel)]="seleccionadas ">
        </ng-select> -->
    </div>
    <div class="app-modal-footer ">
        <div class="form-group text-right ">
            <button (click)="modalPresupuestos.hide() " type="reset " class="btn btn-danger raised mr-2 btn-sm "> Cerrar
            </button>
            <button type="submit " class="btn btn-primary btn-sm raised " (click)="saveBudget()"> Guardar </button>
        </div>
    </div>
</app-modal-basic>
<!-- <app-modal-basic #modalCotizaciones [dialogClass]="'modal-lg'">
    <div class="app-modal-header">
        <h5 class="modal-title">Seleccionar cotizaciones disponibles</h5>
        <button type="button" class="close basic-close" (click)="modalCotizaciones.hide()">
      <span aria-hidden="true">
        <i class="fas fa-times" (click)="modalCotizaciones.hide()"></i>
      </span>
    </button>
    </div>
    <div class="app-modal-body">
        <table class="mt-2 table table-borderless table-striped">
            <thead>
                <tr>
                    <th>Item</th>
                    <th>Fecha</th>
                    <th>Cliente</th>
                    <th>Destino</th>
                    <th>Linea</th>
                    <th>Quien elabora</th>
                    <th>Total COP</th>
                    <th>Total USD</th>
                </tr>
            </thead>
            <tbody>
                <tr *ngFor="let item of cotizaciones" [ngClass]="{'bg-danger text-white': ( item.state == 'Inactivo' )}">
                    <td>
                        <input type="checkbox" [selected]="cotizacionesSeleccionadas.includes(item.id)" [change]=" guardarCotizacion(item.id) ">
                        <label [for]=" item.id " class="ml-1 "> PRES {{ item.id }} </label>
                    </td>
                    <td> {{ item.created_at | date:'dd-MM-YYYY' }} </td>
                    <td> {{ item.customer.name }} </td>
                    <td> {{ item.destiny.name }} </td>
                    <td> {{ item.line }} </td>
                    <td> {{ item.user.person.first_name }} {{ item.user.person.first_surname }} </td>
                    <td> ${{ item.total_cop | currency:'':'' }} </td>
                    <td> ${{ item.total_usd | currency:'':'' }} </td>
                </tr>
            </tbody>
        </table>
    </div>
    <div class="app-modal-footer ">
        <div class="form-group text-right ">
            <button (click)="modalPresupuestos.hide() " type="reset " class="btn btn-danger raised mr-2 btn-sm "> Cerrar
        </button>
            <button type="submit " class="btn btn-primary btn-sm raised " (click)="modalCotizaciones.hide(); closeModalCotizaciones() "> Guardar </button>
        </div>
    </div>
</app-modal-basic> -->
