<div class="card">
    <div class="card-header">
        <div class="card-title mt-3 text-center">
            <h5>Negocios</h5>
        </div>
    </div>
    <div class="card-body">
        <div class="row ml-0 mr-0" style="border-top: solid black">
            <div class="col-md-2 mt-3 mb-3">
                <img [src]="negocio.empresa.logo" alt="Logo para la empresa"
                    style="max-width: -webkit-fill-available" />
            </div>
            <div class="col-md-2 mt-3">
                <label>{{ negocio.id }}</label>
                <p class="d-block m-0">{{ negocio.pais }}</p>
                <p class="d-block m-0">{{ negocio.fechaEntrega | date }}</p>
                <p class="d-block m-0">{{ negocio.empresa.name }}</p>
                <p class="d-block m-0">{{ negocio.contacto }}</p>
            </div>
            <div class="col-md-6 mt-3">
                <label for="" class="d-block">Detalles</label>
                <p class="text-justify">{{ negocio.detalles }}</p>
            </div>
            <div class="col-md-2 mt-3 mb-3">
                <img [src]="negocio.qr" alt="qrNegocio" style="max-width: -webkit-fill-available" />
            </div>
        </div>
        <div class="row mr-0 ml-0" style="border-top: solid black">
            <div class="col-md-8 mt-3">
                <div>
                    <h6>Presupuestos</h6>
                    <table class="table table-bordered">
                        <thead class="table-dark text-center">
                            <th class="col-md-8">Descripción</th>
                            <th class="col-md-2">Fecha</th>
                            <th class="col-md-2">Valor</th>
                        </thead>
                        <tbody style="font-weight: 100">
                            <tr *ngFor="let pres of negocio.presupuestos">
                                <td scope="row">{{ pres.descripcion }}</td>
                                <td>{{ pres.fecha | date }}</td>
                                <td>$ {{ pres.valor | number }}</td>
                            </tr>
                            <tr>
                                <td scope="row" colspan="2"><strong>Agregar Presupuesto(s)</strong></td>
                                <td class="text-center btn btn-success btn-block" role="button"
                                    (click)="addPresupuesto('Presupuesto')">
                                    <i class="fa fa-plus"></i>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <div>
                    <h6>Cotizaciones</h6>
                    <table class="table table-bordered">
                        <thead class="table-dark text-center">
                            <th class="col-md-8">Descripción</th>
                            <th class="col-md-2">Fecha</th>
                            <th class="col-md-2">Valor</th>
                        </thead>
                        <tbody style="font-weight: 100">
                            <tr *ngFor="let coti of negocio.cotizaciones">
                                <td scope="row">{{ coti.descripcion }}</td>
                                <td>{{ coti.fecha | date }}</td>
                                <td>$ {{ coti.valor | number }}</td>
                            </tr>
                            <tr>
                                <td scope="row" colspan="2" ><strong>Agregar Cotizacion(es)</strong></td>
                                <td class="text-center btn btn-success btn-block" role="button"
                                    (click)="addPresupuesto('Cotizacion'); modalPresupuestos.show()">
                                    <i class="fa fa-plus"></i>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
            <div class="col-md-4" style="border-left: solid black">
                <ul ngbNav #nav="ngbNav" [(activeId)]="active" class="nav-tabs nav-pills  mt-2">
                    <li [ngbNavItem]="1">
                        <a ngbNavLink>Tareas</a>
                        <ng-template ngbNavContent>
                            <app-tareas-negocio [tareas]="tareas" (addTask)="createTask($event)" (editTask)="editTask($event)"></app-tareas-negocio>
                        </ng-template>
                    </li>
                    <li [ngbNavItem]="2">
                        <a ngbNavLink>History</a>
                        <ng-template ngbNavContent>
                            <div class="text-center">
                                <h6>Historial</h6>
                            </div>
                        </ng-template>
                    </li>
                </ul>

                <div [ngbNavOutlet]="nav" class="mt-2"></div>
            </div>
        </div>
    </div>
</div>

<app-modal-basic #modalPresupuestos [dialogClass]="'modal-lg'">
    <div class="app-modal-header">
        <h5 class="modal-title">Seleccionar {{ modal_title }}</h5>
        <button type="button" class="close basic-close" (click)="modalPresupuestos.hide()">
            <span aria-hidden="true">
                <i class="fas fa-times" (click)="modal.hide()"></i>
            </span>
        </button>
    </div>

    <div class="app-modal-body">
        <br />
        <br />
        <ng-select [items]="dataModal" bindLabel="descripcion" [multiple]="true" [closeOnSelect]="false"
            [selectableGroup]="true" [selectableGroupAsModel]="false" [(ngModel)]="seleccionadas">
        </ng-select>
        <div class="mt-4">
            <h6>Seleccionadas</h6>
            <table class="table table-bordered ">
                <thead class="table-dark text-center">
                    <th class="col-md-8">Descripción</th>
                    <th class="col-md-2">Fecha</th>
                    <th class="col-md-2">Valor</th>
                </thead>
                <tbody class="table-bordered border border-dark" style="font-weight: 100">
                    <tr *ngFor="let data of seleccionadas">
                        <td scope="row">{{ data.descripcion }}</td>
                        <td>{{ data.fecha | date }}</td>
                        <td>$ {{ data.valor | number }}</td>
                    </tr>
                   
                </tbody>
            </table>
        </div>
    </div>
    <div class="app-modal-footer">
        <div class="form-group text-right">
            <button (click)="modalPresupuestos.hide()" type="reset" class="btn btn-danger raised mr-2 btn-sm">
                Cerrar
            </button>
            <button type="submit" class="btn btn-primary btn-sm raised"
                (click)="modalPresupuestos.hide(); closeModal()">
                Guardar
            </button>
        </div>
    </div>
</app-modal-basic>