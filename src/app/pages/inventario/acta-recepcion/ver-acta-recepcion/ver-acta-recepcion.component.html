<div class="row" *ngIf="!loading; else placeholder">
  <div class="col-xl-4 col-lg-12" *ngIf="ActividadesActa.length > 0">
    <div class="card">
      <div class="card-body">
        <div class="card-title">
          <h5 class="text-primary">Seguimiento</h5>
        </div>
        <hr class="line" />
        <ul class="list-group list-group-flush">
          <li
            class="list-group-item px-0"
            *ngFor="let Actividad of ActividadesActa"
          >
            <div class="card-title d-flex justify-content-between">
              <h6>
                <span [class]="AsignarClaseLabel(Actividad.Estado)">{{
                  Actividad.Estado
                }}</span>
              </h6>
            </div>
            <p>
              {{ Actividad.Detalles }} <br />
              <small class="text-muted"> {{ Actividad.Fecha }}</small>
            </p>
          </li>
        </ul>
      </div>
    </div>
  </div>
  <div class="col">
    <div class="card">
      <div class="card-body">
        <app-cabecera [datosCabecera]="datosCabecera"></app-cabecera>
        <hr class="line" />
        <div class="rounded-top table-responsive">
          <table class="table table-bordered table-sm">
            <thead class="bg-light">
              <tr class="text-center text-uppercase">
                <th>Compra</th>
                <th *ngIf="Tipo == 'Bodega'">Bodega</th>
                <th *ngIf="Tipo == 'Punto_Dispensacion'">Punto</th>
                <th>Productos Ingresados</th>
              </tr>
            </thead>
            <tbody>
              <tr class="text-center">
                <td>{{ Datos.Codigo_Compra }}</td>
                <td *ngIf="Tipo == 'Bodega'">{{ Datos.Nombre_Bodega }}</td>
                <td *ngIf="Tipo == 'Punto_Dispensacion'">
                  {{ Datos.Nombre_Bodega }}
                </td>
                <td>
                  {{ Datos.ConteoProductos }} Producto{{
                    Datos.ConteoProductos > 1 ? "s" : ""
                  }}
                  Diferente{{ Datos.ConteoProductos > 1 ? "s" : "" }}
                </td>
              </tr>
            </tbody>
            <thead class="bg-light">
              <tr class="text-center text-uppercase">
                <th>Proveedor</th>
                <th>Dirección</th>
                <th>Teléfono</th>
              </tr>
            </thead>
            <tbody>
              <tr class="text-center">
                <td>{{ Datos.NombreProveedor }}</td>
                <td>{{ Datos.DireccionProveedor }}</td>
                <td>{{ Datos.TelefonoProveedor }}</td>
              </tr>
            </tbody>
          </table>
        </div>
        <h6>Facturas</h6>
        <div class="rounded-top table-responsive">
          <table class="table table-bordered table-sm">
            <thead class="bg-light">
              <tr class="text-center text-uppercase">
                <th>#</th>
                <th>Nombre</th>
                <th>Fecha</th>
                <th>Archivo</th>
              </tr>
            </thead>
            <tbody>
              <tr
                *ngFor="let item of Facturas; let i = index"
                class="text-center"
              >
                <td>{{ i + 1 }}</td>
                <td>{{ item.Factura | uppercase }}</td>
                <td>{{ item.Fecha_Factura }}</td>
                <td>
                  <!-- <a
                    href="{{ envi.ruta }}ARCHIVOS/FACTURAS_COMPRA/{{
                      item.Archivo_Factura
                    }}"
                    target="_blank"
                    title="Descargar Archivo"
                    ><i class="fas fa-file-pdf"></i
                  ></a> -->
                </td>
              </tr>
            </tbody>
          </table>
        </div>
        <hr />
        <div class="rounded-top table-responsive">
          <table class="table table-borderless table-sm">
            <thead class="bg-light">
              <tr class="text-uppercase">
                <th>Observaciones</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>{{ Datos.Observaciones | uppercase }}</td>
              </tr>
            </tbody>
          </table>
        </div>
        <ng-container *ngIf="Productos">
          <h6>Productos</h6>
          <div class="rounded-top table-responsive">
            <table class="table table-bordered table-sm">
              <thead class="bg-light">
                <tr class="text-center text-uppercase">
                  <th>#</th>
                  <th>Producto</th>
                  <th>Solicitadas</th>
                  <th></th>
                </tr>
              </thead>
              <tbody>
                <tr
                  *ngFor="let item of Productos; let i = index"
                  id="fila{{ i }}"
                  class="text-center"
                >
                  <td class="align-middle">
                    {{ i + 1 }}
                  </td>
                  <td class="align-middle">
                    <strong>{{ item.Nombre_Comercial }}</strong>
                    <span class="text-muted" style="font-size: smaller">
                      {{ item.Nombre_Producto }}
                    </span>
                  </td>
                  <td class="align-middle">
                    {{ item.Cantidad_Solicitada | number | puntos }}
                  </td>
                  <td class="align-middle" colspan="6">
                    <div class="rounded-top table-responsive">
                      <table class="table table-bordered table-sm">
                        <thead class="bg-light">
                          <tr class="text-center text-uppercase">
                            <th>Cantidad</th>
                            <th>Lote</th>
                            <th>FV</th>
                            <th>Precio</th>
                            <th>Iva</th>
                            <th>Subtotal</th>
                          </tr>
                        </thead>
                        <tbody>
                          <tr
                            *ngFor="let lote of item.Lotes"
                            class="text-center"
                          >
                            <td class="align-middle">
                              {{ lote.Cantidad | number | puntos }}
                            </td>
                            <td class="align-middle">
                              {{ lote.Lote }}
                            </td>
                            <td class="align-middle">
                              {{ lote.Fecha_Vencimiento }}
                            </td>
                            <td class="align-middle">
                              {{ lote.Precio | currency : "COP" }}
                            </td>
                            <td class="align-middle">{{ lote.Impuesto }}%</td>
                            <td class="align-middle">
                              {{
                                lote.Precio * lote.Cantidad | currency : "COP"
                              }}
                            </td>
                          </tr>
                        </tbody>
                      </table>
                    </div>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </ng-container>
        <app-list-items
          [title1]="'SUBTOTAL'"
          [var1]="Datos.Subtotal"
          [type1]="'cop'"
          [title2]="'IVA'"
          [var2]="Datos.Impuesto"
          [type2]="'cop'"
          [title3]="'TOTAL'"
          [var3]="Datos.Total"
          [type3]="'cop'"
        ></app-list-items>
        <button
          *ngIf="Datos.Estado == 'Pendiente'"
          (click)="aprobarActa(Datos.Id_Acta_Recepcion, Datos.Id_Bodega_Nuevo)"
          type="button"
          class="btn btn-primary btn-block mt-3"
        >
          Aprobar acta
        </button>
      </div>
    </div>
  </div>
</div>

<swal #confirmacionSwal title="" text="" type=""></swal>

<ng-template #placeholder>
  <app-placeholder-form></app-placeholder-form>
</ng-template>
