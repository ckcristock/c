<div class="card">
    <div class="card-body">
        <div class="card-title">
            <h5>Contratos</h5>
            <p>Todos los contratos registrados en nuestra base de datos.</p>
        </div>
        <div class="form-row mt-4">
            <div class="form-group col-md-2" *ngIf="companies.length>1">
                <label for="">Empresa</label>
                <ng-select class="mr-1" [items]="companies" [(ngModel)]="filtros.company" (change)="getAllContracts()" name="empresa" bindLabel="text" bindValue="value" loadingText="loading" ngDefaultControl>
                </ng-select>
            </div>
            <div class="form-group col-md-2">
                <label for="">Funcionario</label>
                <input type="text" class="form-control" [(ngModel)]="filtros.person" (change)="getAllContracts()" name="funcionario" autocomplete="off" placeholder="Buscar" />
            </div>
            <div class="form-group col-md-3">
                <label for="">Grupos</label>
                <ng-select class="mr-1" [items]="groups" [(ngModel)]="filtros.group" (change)="getAllContracts()" name="group" bindLabel="text" bindValue="value" loadingText="loading" ngDefaultControl>
                </ng-select>
            </div>
            <div class="form-group col-md-3">
                <label for="">Dependencias</label>
                <ng-select class="mr-1 mb-3" [items]="dependencies" [(ngModel)]="filtros.dependency" (change)="getAllContracts()" name="dependency" bindLabel="text" bindValue="value" loadingText="loading" ngDefaultControl>
                </ng-select>
            </div>
            <div class="form-group col-md-2">
                <label for="">Cargo</label>
                <ng-select class="mr-1 mb-3" [items]="positions" bindLabel="text" bindValue="value" [(ngModel)]="filtros.position" (change)="getAllContracts()" name="position" loadingText="loading" ngDefaultControl>
                </ng-select>
            </div>
        </div>
    </div>
</div>
<div class="row">
    <div class="col-10">
        <div class="card card-body">


            <div *ngIf="!loading && contracts.length > 0; else notData">
                <table class="table w-100 table-striped table-bordered">
                    <thead>
                        <tr>
                            <th>-</th>
                            <th>Funcionario</th>
                            <th>Cargo</th>
                            <th>Acciones</th>
                        </tr>
                    </thead>

                    <tbody>
                        <tr *ngFor="let contract of contracts">
                            <td>
                                <img alt="" class="rounded-circle avatar-sm" src="{{ contract.image | image: 'users' }}" alt="" />
                            </td>
                            <td>
                                <strong>
                                  {{ contract.first_name | titlecase }}
                                  {{ contract.first_surname | titlecase }}
                                </strong>
                            </td>
                            <td>{{ contract.position }}</td>
                            <td class="text-right">
                                <div class="btn-group btn-group-sm " role="group" aria-label="Basic example">
                                    <button type="button" class="btn btn-outline-primary btn-sm" placement="bottom" ngbTooltip="Descargar">
                  <i class="fas fa-download"></i>
                </button>
                                    <button type="button" class="btn btn-outline-primary btn-sm" [routerLink]="[
                    '/ajustes/informacion-base/funcionario/',
                    contract.id
                  ]" placement="bottom" ngbTooltip="Ver Perfil">
                  <i class="fas fa-address-card"></i>
                </button>
                                </div>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
        <ngb-pagination class="d-flex justify-content-center pagination-rounded pagination-sm" [collectionSize]="pagination.collectionSize" (pageChange)="getAllContracts($event)" [pageSize]="pagination.pageSize" [(page)]="pagination.page" aria-label="Default pagination"
            maxSize="5" rotate="true" ellipses="false" boundaryLinks="true" rotate="true" ellipses="false" boundaryLinks="true">
        </ngb-pagination>
    </div>
    <div class="col-2">
        <div class="card">
            <div class="card-body">
                <h6 class="text-center">Contratos por vencer</h6>
                <table *ngIf="!contractData && contractsToExpire.length > 0; else image">
                    <div class="row mt-3 mb-3">
                        <td class="mt-3 mb-3" *ngFor="let contractToExpire of contractsToExpire">
                            <p class="w-40 w-xs-100 mb-0 d-flex align-items-center">
                                <img [src]="contractToExpire.image | image" class="
                    img-thumbnail
                    rounded-circle
                    header-profile-user
                    mx-auto
                    d-block
                  " alt="" />
                                <span class="font-weight-bold ml-2" style="height: 40px">
                  {{ contractToExpire.first_name }}
                  {{ contractToExpire.first_surname }} <br />
                  <small>
                    {{ contractToExpire.date_end }}
                  </small>
                </span>
                            </p>
                        </td>
                    </div>
                </table>
            </div>
            <ngb-pagination class="
          d-flex
          justify-content-center
          pagination-rounded pagination-sm
          ps
        " [collectionSize]="paginationCV.collectionSize" (pageChange)="getContractsToExpire($event)" [pageSize]="paginationCV.pageSize" [(page)]="paginationCV.page" aria-label="Default pagination" maxSize="5" rotate="true" ellipses="true" boundaryLinks="true"
                rotate="true">
            </ngb-pagination>
            <ng-template #image>
                <img width="170px" src="../../../../assets/images/contratos.png" alt="" />
            </ng-template>
        </div>
        <div class="card">
            <div class="card-body">
                <h6 class="text-center">Periodo de prueba</h6>
                <table>
                    <div class="row mt-3 mb-3">
                        <td class="mt-3 mb-3" *ngFor="let contractTrial of contractsTrialPeriod">
                            <p class="w-40 w-xs-100 mb-0 d-flex align-items-center">
                                <img [src]="contractTrial.image | image" class="
                    img-thumbnail
                    rounded-circle
                    header-profile-user
                    mx-auto
                    d-block
                  " alt="" />
                                <span class="font-weight-bold ml-2" style="height: 40px">
                  {{ contractTrial.names }}<br />
                  <small>
                    {{ contractTrial.dates }}
                  </small>
                </span>
                            </p>
                        </td>
                    </div>
                </table>
            </div>
        </div>
    </div>
</div>
<ng-template #notData>
    <app-not-data [loading]="loading"></app-not-data>
</ng-template>