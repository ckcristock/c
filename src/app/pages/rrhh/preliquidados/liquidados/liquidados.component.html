<div class="card">
  <div class="card-body">
    <div class="row card-title d-flex justify-content-between">
      <div class="col-md-6 px-0">
        <img
          src="assets/images/logo2.png"
          class="img-fluid"
          height="45"
          alt=""
        />
      </div>
      <div class="col-md-6 px-0 text-md-right text-center">
        <h4 class="text-primary">
          <app-cabecera [datosCabecera]="datosCabecera"></app-cabecera>
        </h4>
      </div>
    </div>
    <hr class="line" />
    <div *ngIf="!loading && liquidado; else notData">
      <h5 class="text-center">
        Liquidación de {{ liquidado.first_name }} {{ liquidado.second_name }}
        {{ liquidado.first_surname }} {{ liquidado.second_surname }}
      </h5>
      <form [formGroup]="form">
        <mat-horizontal-stepper #stepper [linear]="false">
          <mat-step>
            <ng-template matStepLabel>Causa y fecha</ng-template>
            <h6>1. Causa</h6>
            <div class="row">
              <mat-form-field class="col" appearance="outline">
                <mat-label>Motivo</mat-label>
                <input
                  matInput
                  type="text"
                  placeholder="Ingresa el motivo, ej: retiro voluntario"
                  formControlName="motivo"
                  required
                  autocomplete="off"
                />
              </mat-form-field>
              <mat-form-field class="col" appearance="outline">
                <mat-label>¿Justa causa?</mat-label>
                <mat-select
                  (selectionChange)="justaCausaValidate($event)"
                  formControlName="justa_causa"
                  required
                >
                  <mat-option value="si">Sí</mat-option>
                  <mat-option value="no">No</mat-option>
                </mat-select>
              </mat-form-field>
            </div>
            <h6>2. Fecha</h6>
            <div class="row" *ngIf="liquidado">
              <mat-form-field class="col" appearance="outline">
                <mat-label>Fecha de contratación</mat-label>
                <input
                  matInput
                  type="date"
                  formControlName="fecha_contratacion"
                  readonly
                  required
                />
              </mat-form-field>
              <mat-form-field class="col" appearance="outline">
                <mat-label>Fecha de terminación</mat-label>
                <input
                  matInput
                  type="date"
                  formControlName="fecha_terminacion"
                  (change)="changeParams($event.target.value)"
                  required
                />
              </mat-form-field>
              <mat-form-field class="col" appearance="outline">
                <mat-label>Días a liquidar</mat-label>
                <input
                  matInput
                  type="number"
                  placeholder="Ingresa los días a liquidar"
                  formControlName="dias_liquidados"
                  readonly
                  required
                />
              </mat-form-field>
              <mat-form-field class="col" appearance="outline">
                <mat-label>Días de vacaciones</mat-label>
                <input
                  matInput
                  type="number"
                  placeholder="Ingresa los días de vacaciones"
                  formControlName="dias_vacaciones"
                  required
                />
              </mat-form-field>
              <!-- <mat-form-field class="col" appearance="outline">
                <mat-label>Vacaciones acumuladas</mat-label>
                <input
                  matInput
                  type="number"
                  placeholder="Ingresa el numero"
                  formControlName="vacacionesacumuladas"
                  required
                />
              </mat-form-field> -->
            </div>
            <div class="row">
              <div class="col-12 d-flex justify-content-end">
                <button
                  class="btn btn-default btn-sm"
                  (click)="goForward()"
                  type="button"
                >
                  <i class="fas fa-arrow-right"></i>
                </button>
              </div>
            </div>
          </mat-step>
          <mat-step>
            <ng-template matStepLabel>Bases de cálculo</ng-template>
            <h6>3. Bases de cálculo</h6>
            <div class="row">
              <mat-form-field class="col" appearance="outline">
                <mat-label>Salario base</mat-label>
                <input
                  matInput
                  type="number"
                  placeholder="Ingresa el salario base"
                  formControlName="salario_base"
                  required
                  autocomplete="off"
                />
              </mat-form-field>
              <mat-form-field class="col" appearance="outline">
                <mat-label>Vacaciones base</mat-label>
                <input
                  matInput
                  type="text"
                  placeholder="Ingresa el valor"
                  formControlName="vacaciones_base"
                  required
                  autocomplete="off"
                />
              </mat-form-field>
              <mat-form-field class="col" appearance="outline">
                <mat-label>Cesantías base</mat-label>
                <input
                  matInput
                  type="text"
                  placeholder="Ingresa el valor"
                  formControlName="cesantias_base"
                  required
                  autocomplete="off"
                />
              </mat-form-field>
            </div>
            <h6>4. Opciones adicionales</h6>
            <div class="row">
              <mat-form-field class="col" appearance="outline">
                <mat-label>Dominicales incluidas</mat-label>
                <mat-select formControlName="dominicales_incluidas" required>
                  <mat-option value="Si">Sí</mat-option>
                  <mat-option value="No">No</mat-option>
                </mat-select>
              </mat-form-field>
              <mat-form-field class="col" appearance="outline">
                <mat-label>Cesantías año anterior incluidas</mat-label>
                <mat-select formControlName="cesantias_anterior" required>
                  <mat-option value="Si">Sí</mat-option>
                  <mat-option value="No">No</mat-option>
                </mat-select>
              </mat-form-field>
              <mat-form-field class="col" appearance="outline">
                <mat-label>Intereses de cesantías incluidos</mat-label>
                <mat-select
                  formControlName="intereses_cesantias"
                  value="Si"
                  required
                >
                  <mat-option value="Si" selected>Sí</mat-option>
                  <mat-option value="No">No</mat-option>
                </mat-select>
              </mat-form-field>
            </div>
            <h6>5. Otros</h6>
            <div class="row">
              <mat-form-field class="col" appearance="outline">
                <mat-label>Otros ingresos</mat-label>
                <input
                  matInput
                  type="number"
                  placeholder="Ingresa el valor"
                  formControlName="otros_ingresos"
                  required
                  autocomplete="off"
                />
              </mat-form-field>
              <mat-form-field class="col" appearance="outline">
                <mat-label>Préstamos</mat-label>
                <input
                  matInput
                  type="number"
                  placeholder="Ingresa el valor"
                  formControlName="prestamos"
                  required
                  autocomplete="off"
                />
              </mat-form-field>
              <mat-form-field class="col" appearance="outline">
                <mat-label>Otras deducciones</mat-label>
                <input
                  matInput
                  type="number"
                  placeholder="Ingresa el valor"
                  formControlName="otras_deducciones"
                  required
                  autocomplete="off"
                />
              </mat-form-field>
              <mat-form-field
                class="col-md-12 mat-form-field-no-padding textarea"
                appearance="outline"
              >
                <mat-label>Notas</mat-label>
                <textarea
                  matInput
                  placeholder="Ingresa la notas"
                  rows="5"
                  formControlName="notas"
                  required
                  [cdkTextareaAutosize]="true"
                ></textarea>
              </mat-form-field>
            </div>
            <div class="row">
              <div class="col-12 d-flex justify-content-between">
                <button
                  class="btn btn-default btn-sm"
                  (click)="goBack()"
                  type="button"
                >
                  <i class="fas fa-arrow-left"></i>
                </button>
                <button
                  class="btn btn-default btn-sm"
                  (click)="goForward()"
                  type="button"
                >
                  <i class="fas fa-arrow-right"></i>
                </button>
              </div>
            </div>
          </mat-step>
          <mat-step>
            <ng-template matStepLabel>Resumen de liquidación</ng-template>
            <div class="row">
              <div class="col-lg-6">
                <ul class="list-group list-group-flush">
                  <li [class]="classList">
                    Dias de vacaciones pendientes
                    <span>${{ info.total_vacaciones | number }}</span>
                  </li>
                  <li [class]="classList">
                    Cesantías
                    <span>${{ info.total_cesantias | number }}</span>
                  </li>
                  <li [class]="classList">
                    Interes de cesantías
                    <span>${{ info.total_intereses_cesantias | number }}</span>
                  </li>
                  <li [class]="classList">
                    <strong>Prima de servicios</strong>
                    <strong>${{ info.total_prima | number }}</strong>
                  </li>
                  <li [class]="classList">
                    <strong>Total liquidación</strong>
                    <strong>${{ info.total_liquidacion | number }}</strong>
                  </li>                 
                  <li *ngIf="indemnizacion" [class]="classList">
                    Indemnización por despido
                    <span>${{ info.total_indemnizacion | number }}</span>
                  </li>
                </ul>
              </div>
              <div class="col-lg-6">
                <ul class="list-group list-group-flush">
                  <li [class]="classList">
                    <strong>Sueldo pendiente por cancelar</strong>
                    <strong>$-en desarrollo-</strong>
                  </li>
                  <li [class]="classList">
                    Auxilio de transporte pendiente por cancelar
                    <span>$-en desarrollo-</span>
                  </li>
                  <li [class]="classList">
                    <strong>Otros</strong>
                    <strong>$-en desarrollo-</strong>
                  </li>
                  <li [class]="classList">
                    <strong>Salud</strong>
                    <strong>$-en desarrollo-</strong>
                  </li>
                  <li [class]="classList">
                    <strong>Pensión</strong>
                    <strong>$-en desarrollo-</strong>
                  </li>
                </ul>
              </div>
            </div>
            <hr />
            <div class="row">
              <div class="col-12">
                <ul class="list-group list-group-flush">
                  <li [class]="classList">
                    <strong>TOTAL</strong>
                    <strong>${{ total_liquidacion | number }}</strong>
                  </li>
                </ul>
                <div class="alert alert-danger text-center" role="alert">
                  Al confirmar la liquidación, el empleado no volverá a aparecer
                  en la lista de empleados activos, ni en el siguiente pago de
                  nómina.
                </div>
              </div>
            </div>
            <div class="row d-flex justify-content-between">
              <div class="col">
                <button
                  class="btn btn-default btn-sm"
                  (click)="goBack()"
                  type="button"
                >
                  <i class="fas fa-arrow-left"></i>
                </button>
              </div>
              <div class="col text-right">
                <div class="btn-group" role="group" aria-label="Basic example">
                  <button
                    class="btn btn-danger btn-sm"
                    (click)="cancelButton()"
                  >
                    Cancelar
                  </button>
                  <button
                    [disabled]="!form.valid"
                    class="btn btn-primary btn-sm"
                    (click)="liquidar()"
                    type="button"
                  >
                    Liquidar
                  </button>
                </div>
              </div>
            </div>
          </mat-step>
        </mat-horizontal-stepper>
      </form>
    </div>
  </div>
</div>
<ng-template #notData>
  <app-not-data [loading]="loading"></app-not-data>
</ng-template>
