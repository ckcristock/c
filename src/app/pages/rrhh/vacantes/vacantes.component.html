<div class="card">
    <div class="card-body">
        <div class="card-title d-flex justify-content-between">
            <h4 class="text-primary">Vacantes</h4>
            <div class="btn-group rounded">
                <button type="button" class=" btn btn-primary btn-sm" style="float: right;"
                    [routerLink]="['/rrhh/vacantes-crear']">
                    <i class="fa fa-plus"></i> Agregar
                </button>
                <button class="btn btn-info btn-sm" style="float: right;" (click)="openClose()">
                    <i class="fas fa-sliders-h"></i> Filtros
                </button>
            </div>
        </div>
        <hr class="line">
        <div class="container">
            <mat-accordion multi>
                <mat-expansion-panel class="mat-elevation-z0">
                    <div class="container">
                        <div class="row">
                            <div class="input-group-sm col-md-3">
                                <label for="">Publicación</label>
                                <input type="date" [(ngModel)]="filtros.fecha" class="form-control input-sm" (change)="getJobs()"
                                    placeholder="Filtro Fecha Publicación">
                            </div>
                            <div class="input-group-sm col-md-3">
                                <label for="">Fecha de inicio</label>
                                <input type="date" [(ngModel)]="filtros.fecha_Inicio" class="form-control input-sm"
                                    (change)="getJobs()" placeholder="Filtro Fecha Inicio">
                            </div>
                            <div class="input-group-sm col-md-3">
                                <label for="">Fecha de fin</label>
                                <input type="date" [(ngModel)]="filtros.fecha_Fin" class="form-control input-sm"
                                    (change)="getJobs()" placeholder="Filtro Fecha Fin">
                            </div>
                            <div class="input-group-sm col-md-3">
                                <label for="">Título</label>
                                <input type="text" [(ngModel)]="filtros.titulo" class="form-control input-sm" (change)="getJobs()"
                                    placeholder="Filtro Título">
                            </div>
                        </div>
                        <div class="row mt-4">
                            <div class="col-sm-3">
                                <label for="">Dependencia</label>
                                <ng-select [(ngModel)]="filtros.dependencia" [items]="dependencies" (change)="getJobs()"
                                    bindLabel="text" bindValue="value" loadingText="loading " ngDefaultControl>
                                </ng-select>
                            </div>
                            <div class="input-group-sm col-md-3">
                                <label for="">Cargo</label>
                                <ng-select [(ngModel)]="filtros.cargo" [items]="positions" (change)="getJobs()" bindLabel="text"
                                    bindValue="value" loadingText="loading " ngDefaultControl>
                                </ng-select>
                            </div>
                            <div class="input-group-sm col-md-3">
                                <label for="">Departamento</label>
                                <ng-select [(ngModel)]="filtros.departamento" [items]="department" (change)="getJobs()"
                                    bindLabel="text" bindValue="value" loadingText="loading " ngDefaultControl>
                                </ng-select>
                            </div>
                            <div class="input-group-sm col-md-3">
                                <label for="">Municipio</label>
                                <ng-select [(ngModel)]="filtros.municipio" [items]="municipalities" (change)="getJobs()"
                                    bindLabel="text" bindValue="value" loadingText="loading " ngDefaultControl>
                                </ng-select>
                            </div>
                        </div>
                        <!-- <div class="row">
                            <mat-form-field class="col-lg-2 col-md-3 col-sm-4" appearance="outline">
                                <mat-label> </mat-label>
                                <input matInput type="text" placeholder="">
                            </mat-form-field>
                            <mat-form-field class="col-md-2" appearance="outline">
                                <mat-label> </mat-label>
                                <mat-select>
                                    <mat-option value=""> </mat-option>
                                </mat-select>
                            </mat-form-field>                                
                        </div> -->
                    </div>
                </mat-expansion-panel>
            </mat-accordion>
        </div>
        <div>
            <!-- <select [(ngModel)]="filtros.estado" class="form-control input-sm">
                <option value="">Todos</option>
                <option value="Activo">Activo</option>
                <option value="Anulada">Anulada</option>
            </select> -->
          
        </div>
        <div class="container">
            <table class="table table-bordered table-striped table-sm" style="font-size: small;" *ngIf="!loading && jobs.length > 0; else notData">
                <thead>
                    <tr>
                        <th>Código</th>
                        <th>Publicación</th>
                        <th>Inicio</th>
                        <th>Fin</th>
                        <th>Título</th>
                        <th>Dependencia</th>
                        <th>Cargo</th>
                        <th>Departamento</th>
                        <th>Municipio</th>
                        <th>Estado</th>
                        <th>Acciones</th>
                    </tr>
                </thead>
                <tbody>
                    <tr *ngFor="let job of jobs " class="{{job.state=='Cancelada' ? 'bg-danger text-white' : ''}}">
                        <td> {{ job.code }} </td>
                        <td>
                            {{job.created_at | date: 'dd/M/yyyy'}}
                        </td>
                        <td>
                            {{job.date_start | date: 'dd/M/yyyy'}}
                        </td>
                        <td>
                            {{job.date_end | date: 'dd/M/yyyy'}}
                        </td>
                        <td>
                            {{job.title}}
                        </td>
                        <td>
                            {{job.position.dependency.name}}
                        </td>
                        <td>
                            {{job.position.name}}
                        </td>
                        <td>
                            {{job.municipality.department.name}}
                        </td>
                        <td>
                            {{job.municipality.name}}
                        </td>
                        <td>
                            <div class="text-center">
                                <span
                                    class="label {{job.status=='Activo' ? 'label-success' : 'label-primary'}}">{{job.state}}
                                </span>
                            </div>
                        </td>
                        <td>
                            <div class="text-center">
                                <div ngbDropdown class="dropdown-primary">
                                    <button ngbDropdownToggle class="btn btn-primary btn-sm waves-effect waves-light "
                                        type="button">
                                        <i class="mdi mdi-chevron-down "></i>
                                    </button>
                                    <div ngbDropdownMenu>
                                        <!--  <a *ngIf="job.state!='Cancelada'"
                                            class="dropdown-item waves-light waves-effect caja-botones" href=""
                                            [routerLink]="['/vacanteseditar',job.id]">
                                            <i class="ti-pencil"></i> Editar</a> -->
                                        <a class="dropdown-item text-info  waves-light waves-effect caja-botones"
                                            [routerLink]="['/rrhh/vacantes-ver',job.id]">
                                            <i class="ti-eye"></i> Ver</a>
                                        <a *ngIf="job.state!='Cancelada'"
                                            class="dropdown-item text-danger  waves-light waves-effect caja-botones"
                                            (click)="cancelar(job.id)">
                                            <i class="fa fa-times"></i> Anular</a>
                                    </div>
                                </div>
                            </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <ngb-pagination class="d-flex justify-content-center pagination-rounded pagination-sm" maxSize="5"
                [collectionSize]="pagination.collectionSize " (pageChange)="getJobs($event) "
                [pageSize]="pagination.pageSize " [(page)]="pagination.page " aria-label="Default pagination"
                rotate="true" ellipses="false" boundaryLinks="true" rotate="true" ellipses="false" boundaryLinks="true">
            </ngb-pagination>
        </div>
    </div>
</div>

<ng-template #notData>
    <app-not-data [loading]="loading"></app-not-data>
</ng-template>